-- CHI: Bartolo Sansone	
-- COSA: Nuove schede
-- QUANDO: 20/09/2018


-- Trasporto animali

insert into lookup_tipo_scheda_operatore(code, description, enabled, titolo, firma_data, nome_file) values (46, 'Trasporto Animali - Aut. Tipo 1', true, 'Scheda Operatore', false, 'SchedaOperatore');
insert into lookup_tipo_scheda_operatore(code, description, enabled, titolo, firma_data, nome_file) values (47, 'Trasporto Animali - Aut. Tipo 2', true, 'Scheda Operatore', false,'SchedaOperatore');
insert into lookup_tipo_scheda_operatore(code, description, enabled, titolo, firma_data, nome_file) values (48, 'Trasporto Animali - Primari', true, 'Scheda Operatore', false,'SchedaOperatore');
insert into lookup_tipo_scheda_operatore(code, description, enabled, titolo, firma_data, nome_file) values (49, 'Trasporto Animali - Proprio', true, 'Scheda Operatore', false,'SchedaOperatore');

update scheda_operatore_metadati set enabled = false where tipo_operatore = 46;insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','','','','','','undefined','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','INDIRIZZO SEDE OPERATIVA','','case when upper(oaope.addrline1) is not null then upper(oaope.addrline1) else '' '' end || '', ''|| case when upper(oaope.city) is not null then upper(oaope.city) else '' '' end || '', ''|| case when oaope.postalcode is not null then oaope.postalcode else '' '' end || '', ''|| case when oaope.state is not null then oaope.state else '' '' end as ind_sede_operativa ','organization o left join organization_address oaope on (o.org_id = oaope.org_id and oaope.address_type = 5) ','o.org_id = #orgid# ','zzzz','print');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','INDIRIZZO SEDE OPERATIVA ','indirizzo','case when upper(oaope.addrline1) is not null then upper(oaope.addrline1) else '' '' end || '', ''|| case when upper(oaope.city) is not null then upper(oaope.city) else '' '' end || '', ''|| case when oaope.postalcode is not null then oaope.postalcode else '' '' end || '', ''|| case when oaope.state is not null then oaope.state else '' '' end','organization o left join organization_address oaope on (o.org_id = oaope.org_id and oaope.address_type = 5) ','o.org_id = #orgid# ','zzzzz','screen');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','CODICE FISCALE','','codice_fiscale as codice_fiscale ','organization','org_id = #orgid#','ee','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Lavaggio autorizzato','capitolo','','','','zzzzzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Lavaggio','','concat_ws('','',addrline1,postalcode,city,state,latitude,longitude)','organization_address','org_id = #orgid# and address_type=7','zzzzzzzzzzzzzzzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','DESCRIZIONE STORICA DELLE LINEE DI ATTIVITA'' (MASTER LIST , ATECO, ECC.)','','''trasporto animali''','organization','org_id = #orgid#','nn','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Titolare o Legale Rappresentante','capitolo','','','','o','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46',' Nome Rappresentante ','','nome_rappresentante as nome_titolare ','organization','org_id = #orgid#','p','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','COGNOME TITOLARE','','cognome_rappresentante as cognome_titolare ','organization','org_id = #orgid#','q','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46',' Data Presentazione Richiesta ','','to_char(date1, ''dd/mm/yyyy'') as data_presentazione_richiesta','organization ','org_id = #orgid#','c','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46',' Partita IVA ','','partita_iva as partita_iva ','organization','org_id = #orgid#','e','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46',' Animali Trasportati ','','(SELECT string_agg( lst.description, '', '') AS rif_list from animalitrasportati at left join organization o on o.org_id=at.org_id left join lookup_specie_trasportata lst on at.tipo_animale=lst.code where o.org_id = #orgid#) || '' Descrizione: '' || o.codice10 ','organization o','o.org_id = #orgid#','f','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46',' Numero Registrazione ','BARCODE','account_number as numero_registrazione ','organization ','org_id = #orgid#','g','PRINT');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46',' Numero Registrazione ','','account_number as numero_registrazione ','organization ','org_id = #orgid#','h','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46',' Specie Animali Trasportati ','','','','','i','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Stato','','stato_impresa','organization','org_id = #orgid# ','l','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','LISTA LINEE PRODUTTIVE','capitolo','','','','m','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','ATTIVITA','','distinct norma ||''
''||attivita','ricerche_anagrafiche_old_materializzata','riferimento_id = #orgid# and riferimento_id_nome_col = ''org_id''','n','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Codice fiscale Rappresentante ','','codice_fiscale_rappresentante as codice_fiscale_titolare ','organization','org_id = #orgid#','r','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Data Nascita','','to_char(data_nascita_rappresentante, ''dd/mm/yyyy'') as data_nascita_titolare ','organization','org_id = #orgid#','s','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Comune di nascita ','','luogo_nascita_rappresentante as luogo_nascita_titolare ','organization','org_id = #orgid#','t','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','TELEFONO TITOLARE','','telefono_rappresentante as telefono_titolare ','organization','org_id = #orgid#','u','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Sede legale','capitolo','','','','v','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','INDIRIZZO SEDE LEGALE','','case when upper(oaleg.addrline1) is not null then upper(oaleg.addrline1) else '' '' end || '', ''|| case when upper(oaleg.addrline2) is not null then upper(oaleg.addrline2) else '' '' end || '', ''|| case when upper(oaleg.city) is not null then upper(oaleg.city) else '' '' end || '', ''|| case when oaleg.postalcode is not null then oaleg.postalcode else '' '' end || '', ''|| case when oaleg.state is not null then oaleg.state else '' '' end','organization o left join organization_address oaleg on (o.org_id = oaleg.org_id and oaleg.address_type = 1) ','o.org_id = #orgid#','z','print');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','INDIRIZZO SEDE LEGALE ','indirizzo','case when upper(oaleg.addrline1) is not null then upper(oaleg.addrline1) else '' '' end || '', ''|| case when upper(oaleg.addrline2) is not null then upper(oaleg.addrline2) else '' '' end || '', ''|| case when upper(oaleg.city) is not null then upper(oaleg.city) else '' '' end || '', ''|| case when oaleg.postalcode is not null then oaleg.postalcode else '' '' end || '', ''|| case when oaleg.state is not null then oaleg.state else '' '' end','organization o left join organization_address oaleg on (o.org_id = oaleg.org_id and oaleg.address_type = 1) ','o.org_id = #orgid#','zz','screen');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','SEDE OPERATIVA','capitolo','','','','zzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Scheda Impresa Trasporto Animali ','capitolo','','','','a','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46',' A.S.L.','','asl.description as descr_asl','lookup_site_id asl left join organization o on o.site_id = asl.code','o.org_id = #orgid#','b','screen');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('46','Denominazione','','name as ragione_sociale ','organization','org_id = #orgid#','d','');

update scheda_operatore_metadati set enabled = false where tipo_operatore = 47;insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Scheda Impresa Trasporto Animali ','capitolo','','','','a','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Comune di nascita ','','luogo_nascita_rappresentante as luogo_nascita_titolare ','organization','org_id = #orgid#','t','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Data Nascita','','to_char(data_nascita_rappresentante, ''dd/mm/yyyy'') as data_nascita_titolare ','organization','org_id = #orgid#','s','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','INDIRIZZO SEDE OPERATIVA ','indirizzo','case when upper(oaope.addrline1) is not null then upper(oaope.addrline1) else '' '' end || '', ''|| case when upper(oaope.city) is not null then upper(oaope.city) else '' '' end || '', ''|| case when oaope.postalcode is not null then oaope.postalcode else '' '' end || '', ''|| case when oaope.state is not null then oaope.state else '' '' end','organization o left join organization_address oaope on (o.org_id = oaope.org_id and oaope.address_type = 5) ','o.org_id = #orgid# ','zzzzz','screen');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47',' A.S.L.','','asl.description as descr_asl','lookup_site_id asl left join organization o on o.site_id = asl.code','o.org_id = #orgid#','b','screen');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47',' Data Presentazione Richiesta ','','to_char(date1, ''dd/mm/yyyy'') as data_presentazione_richiesta','organization','org_id = #orgid#','c','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47',' Specie Animali Trasportati ','','','','','i','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Denominazione','','name as ragione_sociale ','organization','org_id = #orgid#','d','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47',' Partita IVA ','','partita_iva as partita_iva ','organization','org_id = #orgid#','e','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Titolare o Legale Rappresentante','capitolo','','','','o','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','CODICE FISCALE','','codice_fiscale as codice_fiscale ','organization','org_id = #orgid#','ee','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','SEDE OPERATIVA','capitolo','','','','zzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Lavaggio autorizzato','capitolo','','','','zzzzzzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Lavaggio','','concat_ws('','',addrline1,postalcode,city,state,latitude,longitude)','organization_address','org_id = #orgid# and address_type=7','zzzzzzzzzzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47',' Numero Registrazione ','BARCODE','account_number as numero_registrazione ','organization ','org_id = #orgid#','g','PRINT');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47',' Numero Registrazione ','','account_number as numero_registrazione ','organization ','org_id = #orgid#','h','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Stato','','stato_impresa','organization','org_id = #orgid# ','l','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','LISTA LINEE PRODUTTIVE','capitolo','','','','m','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','ATTIVITA','','distinct norma ||'' ''||attivita','ricerche_anagrafiche_old_materializzata','riferimento_id = #orgid# and riferimento_id_nome_col = ''org_id''','n','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47',' Nome Rappresentante ','','nome_rappresentante as nome_titolare ','organization','org_id = #orgid#','p','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','COGNOME TITOLARE','','cognome_rappresentante as cognome_titolare ','organization','org_id = #orgid#','q','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Codice fiscale Rappresentante ','','codice_fiscale_rappresentante as codice_fiscale_titolare ','organization','org_id = #orgid#','r','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','TELEFONO TITOLARE','','telefono_rappresentante as telefono_titolare ','organization','org_id = #orgid#','u','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Sede legale','capitolo','','','','v','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47',' Animali Trasportati ','','(SELECT string_agg( lst.description, '', '') AS rif_list from animalitrasportati at left join organization o on o.org_id=at.org_id left join lookup_specie_trasportata lst on at.tipo_animale=lst.code where o.org_id = #orgid#) || '' Descrizione: '' || o.codice10 ','organization o','o.org_id = #orgid#','f','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Responsabile trasporto','capitolo','','','','zzzzzzzzzzzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Cognome','','cf_correntista','organization','org_id = #orgid# ','zzzzzzzzzzzzzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','INDIRIZZO SEDE OPERATIVA','','case when upper(oaope.addrline1) is not null then upper(oaope.addrline1) else '' '' end || '', ''|| case when upper(oaope.city) is not null then upper(oaope.city) else '' '' end || '', ''|| case when oaope.postalcode is not null then oaope.postalcode else '' '' end || '', ''|| case when oaope.state is not null then oaope.state else '' '' end as ind_sede_operativa ','organization o left join organization_address oaope on (o.org_id = oaope.org_id and oaope.address_type = 5) ','o.org_id = #orgid# ','zzzz','print');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Nome','','nome_correntista','organization','org_id = #orgid# ','zzzzzzzzzzzzzzzzzzzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','Telefono','','conto_corrente','organization','org_id = #orgid# ','zzzzzzzzzzzzzzzzzzzzzz','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','INDIRIZZO SEDE LEGALE','','case when upper(oaleg.addrline1) is not null then upper(oaleg.addrline1) else '' '' end || '', ''|| case when upper(oaleg.addrline2) is not null then upper(oaleg.addrline2) else '' '' end || '', ''|| case when upper(oaleg.city) is not null then upper(oaleg.city) else '' '' end || '', ''|| case when oaleg.postalcode is not null then oaleg.postalcode else '' '' end || '', ''|| case when oaleg.state is not null then oaleg.state else '' '' end','organization o left join organization_address oaleg on (o.org_id = oaleg.org_id and oaleg.address_type = 1) ','o.org_id = #orgid#','z','print');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','INDIRIZZO SEDE LEGALE ','indirizzo','case when upper(oaleg.addrline1) is not null then upper(oaleg.addrline1) else '' '' end || '', ''|| case when upper(oaleg.addrline2) is not null then upper(oaleg.addrline2) else '' '' end || '', ''|| case when upper(oaleg.city) is not null then upper(oaleg.city) else '' '' end || '', ''|| case when oaleg.postalcode is not null then oaleg.postalcode else '' '' end || '', ''|| case when oaleg.state is not null then oaleg.state else '' '' end','organization o left join organization_address oaleg on (o.org_id = oaleg.org_id and oaleg.address_type = 1) ','o.org_id = #orgid#','zz','screen');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('47','DESCRIZIONE STORICA DELLE LINEE DI ATTIVITA'' (MASTER LIST , ATECO, ECC.)','','''trasporto animali''','organization','org_id = #orgid#','nn','');

update scheda_operatore_metadati set enabled = false where tipo_operatore = 48;insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48',' A.S.L.','','asl.description as descr_asl','lookup_site_id asl left join organization o on o.site_id = asl.code','o.org_id = #orgid#','b','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48',' Data Presentazione Richiesta ','','to_char(date1, ''dd/mm/yyyy'') as data_presentazione_richiesta','organization ','org_id = #orgid#','c','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','Sede legale','capitolo','','','','i','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','Scheda Impresa Trasporto Animali ','capitolo','','','','a','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48',' Codice Azienda ','','account_number','organization','org_id = #orgid#','e','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48',' Animali Trasportati ','','(SELECT string_agg( lst.description, '', '') AS rif_list from animalitrasportati at left join organization o on o.org_id=at.org_id left join lookup_specie_trasportata lst on at.tipo_animale=lst.code where o.org_id = #orgid#) || '' Descrizione: '' || o.codice10 ','organization o','o.org_id = #orgid#','f','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','Denominazione allevamento','','name as ragione_sociale ','organization','org_id = #orgid#','d','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','ATTIVITA','','distinct norma ||'' ''||attivita','ricerche_anagrafiche_old_materializzata','riferimento_id = #orgid# and riferimento_id_nome_col = ''org_id''','h','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','LISTA LINEE PRODUTTIVE','capitolo','','','','g','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','INDIRIZZO SEDE LEGALE','','case when upper(oaleg.addrline1) is not null then upper(oaleg.addrline1) else '' '' end || '', ''|| case when upper(oaleg.addrline2) is not null then upper(oaleg.addrline2) else '' '' end || '', ''|| case when upper(oaleg.city) is not null then upper(oaleg.city) else '' '' end || '', ''|| case when oaleg.postalcode is not null then oaleg.postalcode else '' '' end || '', ''|| case when oaleg.state is not null then oaleg.state else '' '' end','organization o left join organization_address oaleg on (o.org_id = oaleg.org_id and oaleg.address_type = 1) ','o.org_id = #orgid#','l','print');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','INDIRIZZO SEDE LEGALE ','indirizzo','case when upper(oaleg.addrline1) is not null then upper(oaleg.addrline1) else '' '' end || '', ''|| case when upper(oaleg.addrline2) is not null then upper(oaleg.addrline2) else '' '' end || '', ''|| case when upper(oaleg.city) is not null then upper(oaleg.city) else '' '' end || '', ''|| case when oaleg.postalcode is not null then oaleg.postalcode else '' '' end || '', ''|| case when oaleg.state is not null then oaleg.state else '' '' end','organization o left join organization_address oaleg on (o.org_id = oaleg.org_id and oaleg.address_type = 1) ','o.org_id = #orgid#','m','screen');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','Stato','','stato_impresa','organization','org_id = #orgid# ','ff','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','Animali trasportati','','(SELECT string_agg( lst.description, '', '') AS rif_list from animalitrasportati at left join organization o on o.org_id=at.org_id left join lookup_specie_trasportata lst on at.tipo_animale=lst.code where o.org_id = #orgid#) ','organization o','o.org_id = #orgid#','ee','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('48','DESCRIZIONE STORICA DELLE LINEE DI ATTIVITA'' (MASTER LIST , ATECO, ECC.)','','''trasporto animali''','organization','org_id = #orgid#','hh','');

update scheda_operatore_metadati set enabled = false where tipo_operatore = 49;insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' Scheda Trasportatore "conto proprio" di Equidi','capitolo','','','','a','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' A.S.L.','','asl.description as descr_asl','lookup_site_id asl left join organization o on o.site_id = asl.code','o.org_id = #orgid#','b','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' Data Presentazione Autodichiarazione ','','to_char(date1, ''dd/mm/yyyy'') as data_presentazione_richiesta','organization','org_id = #orgid#','c','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' Cognome Trasportatore ','','cognome_rappresentante','organization','org_id = #orgid# ','d','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49','Nome trasportatore','','nome_rappresentante','organization','org_id = #orgid# ','e','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' Codice Fiscale Trasportatore ','','codice_fiscale_rappresentante','organization','org_id = #orgid# ','f','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' Proprietario/Detentore di','','(SELECT string_agg( lst.description, '', '') AS rif_list from animalitrasportati at left join organization o on o.org_id=at.org_id left join lookup_specie_trasportata lst on at.tipo_animale=lst.code where o.org_id = #orgid#) ','organization o','o.org_id = #orgid#','g','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49','Stato','','stato_impresa','organization','org_id = #orgid# ','h','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49','LISTA LINEE PRODUTTIVE','capitolo','','','','i','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49','ATTIVITA','','distinct norma ||'' ''||attivita','ricerche_anagrafiche_old_materializzata','riferimento_id = #orgid# and riferimento_id_nome_col = ''org_id''','l','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' Indirizzo Residenza ','capitolo','','','','m','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49','indirizzo ','','case when upper(oaleg.addrline1) is not null then upper(oaleg.addrline1) else '' '' end || '', ''|| case when upper(oaleg.addrline2) is not null then upper(oaleg.addrline2) else '' '' end || '', ''|| case when upper(oaleg.city) is not null then upper(oaleg.city) else '' '' end || '', ''|| case when oaleg.postalcode is not null then oaleg.postalcode else '' '' end || '', ''|| case when oaleg.state is not null then oaleg.state else '' '' end','organization o left join organization_address oaleg on (o.org_id = oaleg.org_id and oaleg.address_type = 1) ','o.org_id = #orgid#','n','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' Informazioni Abitazione/Allevamento ','capitolo','','','','o','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49',' Abitazione/Allevamento ','','banca','organization','org_id = #orgid# ','p','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49','Indirizzo Abitazione/Allevamento ','','case when upper(oaope.addrline1) is not null then upper(oaope.addrline1) else '' '' end || '', ''|| case when upper(oaope.city) is not null then upper(oaope.city) else '' '' end || '', ''|| case when oaope.postalcode is not null then oaope.postalcode else '' '' end || '', ''|| case when oaope.state is not null then oaope.state else '' '' end','organization o left join organization_address oaope on (o.org_id = oaope.org_id and oaope.address_type = 5) ','o.org_id = #orgid# ','q','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('49','DESCRIZIONE STORICA DELLE LINEE DI ATTIVITA'' (MASTER LIST , ATECO, ECC.)','','''trasporto animali''','organization','org_id = #orgid#','ll','');

--farmacie

update scheda_operatore_metadati set enabled = false where tipo_operatore = 19;insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','INFORMAZIONE PRIMARIA','capitolo','','','','a','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','ASL','','asl.description as descr_asl ','lookup_site_id asl left join organization o on o.site_id = asl.code ','o.org_id = #orgid#','abc','screen');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','TIPOLOGIA','','o.banca','organization o','o.org_id = #orgid#','B','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','IMPRESA','','name as ragione_sociale ','organization ','org_id = #orgid#','BA','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','CATEGORIA DI RISCHIO','','case when categoria_rischio::text is null then ''N.D.'' else categoria_rischio::text end ','organization ','org_id = #orgid#','bd','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','VENDITA DETTAGLIO','capitolo','','','','d','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','DATA RICEZIONE AUTORIZZAZIONE','','case when data_ric_dettaglio is not null then to_char ( data_ric_dettaglio, ''dd/mm/yyyy'') else '' '' end ','organization','org_id  = #orgid#','DA','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','NUMERO AUTORIZZAZIONE','','case when num_ric_dettaglio is not null and num_ric_dettaglio!= '''' then num_ric_dettaglio else num_ric_ingrosso end','organization','org_id  = #orgid#','DB','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','ASL ','asl','asl.description as descr_asl ','lookup_site_id asl left join organization o on o.site_id = asl.code ','o.org_id = #orgid#','ab','print');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','STATO','','case when stato is null then ''ATTIVO'' else stato end || '' '' || ''in data '' || case when data_cambio_stato is not null then to_char ( data_cambio_stato, ''dd/mm/yyyy'') else '' '' end ','organization ','org_id = #orgid# ','BB','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','INDIRIZZO','','coalesce ( addrline1 , '' '' ) || '', '' ||coalesce ( city , '' '' ) || '' , '' ||coalesce ( state , '' '' ) ||'','' || coalesce ( country , '' '' ) ||'','' || coalesce ( postalcode , '' '' )||'',
Latitudine: '' || latitude ||'', Longitudine: '' || longitude
','organization o left join organization_address oa on o.org_id=oa.org_id','o.org_id = #orgid#','BC','');insert into scheda_operatore_metadati(tipo_operatore, label, attributo, sql_campo, sql_origine, sql_condizione, ordine, destinazione) values ('19','PROSSIMO CONTROLLO CON LA TECNICA DELLA SORVEGLIANZA','','case when prossimo_controllo is not null then to_char(prossimo_controllo, ''dd/mm/yyyy'') else to_char (now(),''dd/mm/yyyy'') end','organization ','org_id  = #orgid#','C','');