### ELENCO QUERY PER LA COSTRUZIONE  DELLE CHEDE PDF  ##

### QUERY PER LA SELEZIONE DEI DATI DI UN CAMPIONE ###
GET_CONTROLLO = select cu.problem, o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.domicilio_digitale as domicilio_digitale, o.data_nascita_rappresentante, o.alert as tipologia, CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.city WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.city WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.city END AS comune, CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.addrline1 WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.addrline1 WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.addrline1 END AS indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid= ?
GET_CONTROLLO_MOLLUSCHI = select cu.problem, o.site_id as id_asl,asl.description as descr_asl, o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, lz.description as tipo_acqua, lz.code as codice_acqua, lca.description as classificazione,o.data_nascita_rappresentante, o.alert as tipologia, o.cun as cun, oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN lookup_zone_di_produzione lz ON lz.code = o.tipologia_acque LEFT JOIN lookup_classi_acque lca ON lca.code = o.classificazione LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
#GET_CONTROLLO_OPU=select distinct o.nome_rapp_sede_legale as nome_rappresentante, o.cognome_rapp_sede_legale as cognome_rappresentante,sogg.data_nascita as data_nascita_rappresentante,sogg.comune_nascita as luogo_nascita_rappresentante,o.indirizzo_stab as indirizzo, o.comune_stab as comune,cu.problem, o.id_asl as id_asl,asl.description as descr_asl, o.ragione_sociale as ragione_sociale, o.partita_iva as codice_fiscale, o.codice_registrazione as n_reg, '' as approval_number, '' as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto,  cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque,  cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, com.nome as sede_legale,comsogg.nome as citta_legale_rapp,indsogg.via as indirizzo_legale_rapp, indsogg.provincia as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.via as indirizzo_legale,o.nome_rapp_sede_legale as nome_rapp_stab, o.cognome_rapp_sede_legale as cognome_rapp_stab, sogg.comune_nascita, o.domicilio_digitale as domicilio_digitale, sogg.data_nascita, '' as tipologia,  o.comune_Stab,  o.indirizzo_stab from lookup_site_id asl,ticket cu, opu_operatori_denormalizzati_view o  join opu_operatore op on o.id_opu_operatore = op.id join opu_rel_operatore_soggetto_fisico rosf on rosf.id_operatore=op.id join opu_soggetto_fisico sogg on sogg.id = rosf.id_soggetto_fisico left join opu_indirizzo indsogg on indsogg.id = sogg.indirizzo_id join comuni1 comsogg on comsogg.id = indsogg.comune left join opu_indirizzo oa1 on oa1.id = op.id_indirizzo left join comuni1 com on com.id = oa1.comune   where cu.id_stabilimento = o.id_stabilimento and o.id_asl = asl.code and cu.ticketid= ?
GET_CONTROLLO_OPU = select distinct sogg.nome as nome_rappresentante, sogg.cognome as cognome_rappresentante,sogg.data_nascita as data_nascita_rappresentante,sogg.comune_nascita as luogo_nascita_rappresentante,indstab.via as indirizzo, comstab.nome as comune,cu.problem, stab.id_asl as id_asl,asl.description as descr_asl, op.ragione_sociale as ragione_sociale, op.partita_iva as codice_fiscale, stab.numero_registrazione as n_reg, stab.numero_registrazione as approval_number, '' as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto,  cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque,  cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, com.nome as sede_legale,comsogg.nome as citta_legale_rapp,indsogg.via as indirizzo_legale_rapp, indsogg.provincia as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, CASE WHEN oa1.via='' THEN indsogg.via  ELSE oa1.via  END AS indirizzo_legale,soggstab.nome as nome_rapp_stab, soggstab.cognome as cognome_rapp_stab, soggstab.comune_nascita, op.domicilio_digitale as domicilio_digitale, soggstab.data_nascita,  ml8.path_descrizione as tipologia,  comstab.nome as comune_Stab,  indstab.via as indirizzo_stab  from ticket cu left join lookup_site_id asl on asl.code = cu.site_id left join opu_stabilimento stab on stab.id = cu.id_stabilimento left join opu_operatore op on stab.id_operatore = op.id left join opu_rel_operatore_soggetto_fisico rosf on rosf.id_operatore=op.id and rosf.enabled left join opu_soggetto_fisico sogg on sogg.id = rosf.id_soggetto_fisico left join opu_indirizzo indsogg on indsogg.id = sogg.indirizzo_id left join comuni1 comsogg on comsogg.id = indsogg.comune  left join opu_indirizzo oa1 on oa1.id = op.id_indirizzo left join comuni1 com on com.id = oa1.comune left join opu_indirizzo indstab on indstab.id = stab.id_indirizzo left join comuni1 comstab on comstab.id = indstab.comune left join opu_soggetto_fisico soggstab on soggstab.id = stab.id_soggetto_fisico LEFT JOIN linee_attivita_controlli_ufficiali culinee on culinee.id_controllo_ufficiale = cu.ticketid and culinee.trashed_date is null LEFT JOIN opu_relazione_stabilimento_linee_produttive rel on rel.id = culinee.id_linea_attivita LEFT JOIN ml8_linee_attivita_nuove_materializzata ml8 on ml8.id_nuova_linea_attivita = rel.id_linea_produttiva  where cu.id_stabilimento = stab.id and (stab.id_asl = asl.code or stab.id_asl not in (201, 202, 203, 205, 206, 207, 204)) and cu.ticketid= ?
GET_CONTROLLO_OPU_RICHIESTE = select distinct sogg.nome as nome_rappresentante, sogg.cognome as cognome_rappresentante,sogg.data_nascita as data_nascita_rappresentante,sogg.comune_nascita as luogo_nascita_rappresentante,indstab.via as indirizzo, comstab.nome as comune,cu.problem, stab.id_asl as id_asl,asl.description as descr_asl, op.ragione_sociale as ragione_sociale, op.partita_iva as codice_fiscale, stab.numero_registrazione as n_reg, '' as approval_number, '' as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto,  cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque,  cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, com.nome as sede_legale,comsogg.nome as citta_legale_rapp,indsogg.via as indirizzo_legale_rapp, indsogg.provincia as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.via as indirizzo_legale,soggstab.nome as nome_rapp_stab, soggstab.cognome as cognome_rapp_stab, soggstab.comune_nascita, op.domicilio_digitale as domicilio_digitale, soggstab.data_nascita, '' as tipologia,  comstab.nome as comune_Stab,  indstab.via as indirizzo_stab  from ticket cu join lookup_site_id asl on asl.code = cu.site_id join suap_ric_scia_stabilimento stab on stab.alt_id = cu.alt_id join suap_ric_scia_operatore op on stab.id_operatore = op.id join suap_ric_scia_rel_operatore_soggetto_fisico rosf on rosf.id_operatore=op.id and rosf.enabled join suap_ric_scia_soggetto_fisico sogg on sogg.id = rosf.id_soggetto_fisico left join opu_indirizzo indsogg on indsogg.id = sogg.indirizzo_id join comuni1 comsogg on comsogg.id = indsogg.comune  left join opu_indirizzo oa1 on oa1.id = op.id_indirizzo left join comuni1 com on com.id = oa1.comune left join opu_indirizzo indstab on indstab.id = stab.id_indirizzo join comuni1 comstab on comstab.id = indstab.comune left join suap_ric_scia_soggetto_fisico soggstab on soggstab.id = stab.id_soggetto_fisico where cu.alt_id = stab.alt_id and stab.id_asl = asl.code and cu.ticketid= ?
GET_CONTROLLO_SINTESIS = select distinct sogg.nome as nome_rappresentante, sogg.cognome as cognome_rappresentante,sogg.data_nascita as data_nascita_rappresentante,sogg.comune_nascita as luogo_nascita_rappresentante,indstab.via as indirizzo, comstab.nome as comune,cu.problem, stab.id_asl as id_asl,asl.description as descr_asl, op.ragione_sociale as ragione_sociale, op.partita_iva as codice_fiscale, stab.numero_registrazione as n_reg, stab.approval_number as approval_number, '' as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto,  cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque,  cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, com.nome as sede_legale,comsogg.nome as citta_legale_rapp,indsogg.via as indirizzo_legale_rapp, indsogg.civico as civico_indirizzo_legale_rapp, indsogg.provincia as provincia_legale_rapp, sogg.email as domicilio_digitale_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.via as indirizzo_legale,oa1.civico as civico_indirizzo_legale, soggstab.nome as nome_rapp_stab, soggstab.cognome as cognome_rapp_stab, soggstab.comune_nascita, op.domicilio_digitale as domicilio_digitale, soggstab.data_nascita, ml8.attivita as tipologia,  comstab.nome as comune_Stab,  indstab.via as indirizzo_stab,indstab.civico as civico_indirizzo_stab  from ticket cu join lookup_site_id asl on asl.code = cu.site_id join sintesis_stabilimento stab on stab.alt_id = cu.alt_id join sintesis_operatore op on stab.id_operatore = op.id left join sintesis_rel_operatore_soggetto_fisico rosf on rosf.id_operatore=op.id and rosf.enabled left join sintesis_soggetto_fisico sogg on sogg.id = rosf.id_soggetto_fisico left join sintesis_indirizzo indsogg on indsogg.id = sogg.indirizzo_id left join comuni1 comsogg on comsogg.id = indsogg.comune  left join sintesis_indirizzo oa1 on oa1.id = op.id_indirizzo left join comuni1 com on com.id = oa1.comune left join sintesis_indirizzo indstab on indstab.id = stab.id_indirizzo join comuni1 comstab on comstab.id = indstab.comune left join sintesis_soggetto_fisico soggstab on soggstab.id = stab.id_soggetto_fisico left join linee_attivita_controlli_ufficiali lincu on lincu.id_controllo_ufficiale = cu.ticketid left join sintesis_relazione_stabilimento_linee_produttive rel on rel.id = lincu.id_linea_attivita left join ml8_linee_attivita_nuove_materializzata ml8 on ml8.id_nuova_linea_attivita = rel.id_linea_produttiva where lincu.trashed_date is null and  cu.alt_id = stab.alt_id and stab.id_asl = asl.code and cu.ticketid=  ?
GET_CONTROLLO_STABILIMENTI_MACELLI = select distinct oa5.addrline1 as indirizzo , o.site_id as id_asl, asl.description as descr_asl, o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, oa1.city as sede_legale, oa1.addrline1 as indirizzo_legale, oa5.city as comune , 'N.D' as num_verbale, tic.data_Macellazione as data_referto, vpm_veterinario as componente_nucleo, vpm_veterinario_2 as componente_nucleo_due, vpm_veterinario_3 as componente_nucleo_tre,'' as componente_nucleo_quattro, '' as componente_nucleo_cinque, '' as componente_nucleo_sei, '' as componente_nucleo_sette, '' as componente_nucleo_otto, '' as componente_nucleo_nove, '' as componente_nucleo_dieci, '' as citta_legale_rapp, '' as indirizzo_legale_rapp, '' as provincia_legale_rapp, -1 as id_controllo_ufficiale, data_macellazione as data_fine_controllo, o.nome_rappresentante as nome_rappresentante, o.cognome_rappresentante as cognome_rappresentante, o.luogo_nascita_rappresentante as luogo_nascita_rappresentante, o.data_nascita_rappresentante as data_nascita_rappresentante,  'N.D'as tipologia from organization o  join lookup_site_id asl on o.site_id = asl.code  join m_vpm_tamponi tic on tic.id_macello=o.org_id join  m_vpm_capi_tamponi associazione on associazione.id_m_vpm_tamponi = tic.id join m_capi capi on capi.id = associazione.id_m_capo LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where 1=1 and associazione.trashed_date is null and o.trashed_date is null
GET_CONTROLLO_OPU_MACELLI = select distinct o.indirizzo_stab as indirizzo , o.id_asl as id_asl, o.stab_asl as descr_asl, o.domicilio_digitale as domicilio_digitale, o.ragione_sociale as ragione_sociale, o.partita_iva as codice_fiscale, o.numero_registrazione as n_reg, '' as approval_number, '' as tipo_impresa, o.comune_sede_legale as sede_legale, o.indirizzo_sede_legale as indirizzo_legale, o.comune_sede_legale as comune , 'N.D' as num_verbale, tic.data_Macellazione as data_referto, vpm_veterinario as componente_nucleo, vpm_veterinario_2 as componente_nucleo_due, vpm_veterinario_3 as componente_nucleo_tre,'' as componente_nucleo_quattro, '' as componente_nucleo_cinque, '' as componente_nucleo_sei, '' as componente_nucleo_sette, '' as componente_nucleo_otto, '' as componente_nucleo_nove, '' as componente_nucleo_dieci, '' as citta_legale_rapp, '' as indirizzo_legale_rapp, '' as provincia_legale_rapp, -1 as id_controllo_ufficiale, data_macellazione as data_fine_controllo, o.nome_rapp_sede_legale as nome_rappresentante, o.cognome_rapp_sede_legale as cognome_rappresentante, '' as luogo_nascita_rappresentante, '' as data_nascita_rappresentante,  'N.D'as tipologia from opu_operatori_denormalizzati_view o  join m_vpm_tamponi tic on tic.id_macello=o.alt_id join  m_vpm_capi_tamponi associazione on associazione.id_m_vpm_tamponi = tic.id join m_capi capi on capi.id = associazione.id_m_capo where 1=1 and associazione.trashed_date is null  
GET_CONTROLLO_SINTESIS_MACELLI = select distinct indoperativa.via as indirizzo , s.id_asl as id_asl, asl.description as descr_asl, o.domicilio_digitale as domicilio_digitale, o.ragione_sociale as ragione_sociale, o.partita_iva as codice_fiscale, '' as n_reg, s.approval_number as approval_number, '' as tipo_impresa, comunilegale.nome as sede_legale, indlegale.via as indirizzo_legale, comunilegale.nome as comune , 'N.D' as num_verbale, tic.data_Macellazione as data_referto, vpm_veterinario as componente_nucleo, vpm_veterinario_2 as componente_nucleo_due, vpm_veterinario_3 as componente_nucleo_tre,'' as componente_nucleo_quattro, '' as componente_nucleo_cinque, '' as componente_nucleo_sei, '' as componente_nucleo_sette, '' as componente_nucleo_otto, '' as componente_nucleo_nove, '' as componente_nucleo_dieci, '' as citta_legale_rapp, '' as indirizzo_legale_rapp, '' as provincia_legale_rapp, -1 as id_controllo_ufficiale, data_macellazione as data_fine_controllo, sf.nome as nome_rappresentante, sf.cognome as cognome_rappresentante, '' as luogo_nascita_rappresentante, '' as data_nascita_rappresentante,  'N.D' as tipologia from sintesis_stabilimento s  join sintesis_operatore o on s.id_operatore = o.id join sintesis_indirizzo indoperativa on indoperativa.id = s.id_indirizzo join sintesis_indirizzo indlegale on indlegale.id = o.id_indirizzo left join lookup_site_id asl on asl.code = s.id_asl left join comuni1 comunilegale on comunilegale.id = indlegale.comune left join sintesis_rel_operatore_soggetto_fisico relsf on relsf.id_operatore = o.id left join sintesis_soggetto_fisico sf on sf.id = relsf.id_soggetto_fisico join m_vpm_tamponi tic on tic.id_macello=s.alt_id join  m_vpm_capi_tamponi associazione on associazione.id_m_vpm_tamponi = tic.id  join m_capi capi on capi.id = associazione.id_m_capo where 1=1 and associazione.trashed_date is null  
GET_CONTROLLO_STABILIMENTI = select cu.problem, o.tipologia as tipologia_operatore, o.site_id as id_asl, asl.description as descr_asl, o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci,oa1.city as sede_legale, oa1.addrline1 as indirizzo_legale, oa5.city as comune, tic.city_legale_rapp as citta_legale_rapp, tic.address_legale_rapp as indirizzo_legale_rapp,tic.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, cu.data_fine_controllo, oa5.addrline1 as indirizzo, tic.comment as nome_rappresentante, tic.solution as cognome_rappresentante, tic.location as luogo_nascita_rappresentante, tic.critical as data_nascita_rappresentante, (l.description || ' ' || sa.attivita )as tipologia from lookup_site_id asl,ticket cu LEFT JOIN ticket tic ON  tic.org_id = cu.org_id and tic.tipologia = 4, organization o LEFT JOIN stabilimenti_sottoattivita sa on  o.org_id = sa.id_stabilimento LEFT JOIN lookup_categoria l on  sa.codice_sezione = l.code LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.trashed_date is null and o.impianto = sa.codice_impianto and cu.ticketid = ? and tic.trashed_date is null order by tic.entered desc
GET_CONTROLLO_MERCATI = select cu.problem, o.site_id as id_asl, asl.description as descr_asl, o.domicilio_digitale as domicilio_digitale,  o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.direct_bill, case when o.tipologia=3 and o.direct_bill=true then 'MERCATO ITTICO' end as tipologia, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei,cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci,oa1.city as sede_legale, oa1.addrline1 as indirizzo_legale, oa5.city as comune, tic.city_legale_rapp as citta_legale_rapp, tic.address_legale_rapp as indirizzo_legale_rapp, tic.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, cu.data_fine_controllo, oa5.addrline1 as indirizzo, o.nome_rappresentante as nome_rappresentante, o.cognome_rappresentante as cognome_rappresentante, o.luogo_nascita_rappresentante as luogo_nascita_rappresentante, o.data_nascita_rappresentante as data_nascita_rappresentante from lookup_site_id asl,ticket cu LEFT JOIN ticket tic ON  tic.org_id = cu.org_id and tic.tipologia = 4, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_FARMACOSORVEGLIANZA = select cu.problem, o.site_id as id_asl,asl.description as descr_asl, o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, o.partita_iva as codice_fiscale, CASE WHEN o.num_ric_dettaglio IS NOT NULL AND o.num_ric_ingrosso IS NOT NULL THEN o.num_ric_dettaglio || ' - ' || o.num_ric_ingrosso WHEN o.num_ric_dettaglio is not null and o.num_ric_ingrosso is null THEN o.num_ric_dettaglio WHEN o.num_ric_dettaglio is null and o.num_ric_ingrosso is not null THEN o.num_ric_ingrosso END AS n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo,oa5.city as comune, oa5.addrline1 as indirizzo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.num_ric_dettaglio IS NOT NULL AND o.num_ric_ingrosso IS NOT NULL THEN 'Commercio ingrosso/dettaglio farmaci' WHEN o.num_ric_dettaglio is not null and o.num_ric_ingrosso is null THEN 'Commercio dettaglio farmaci' WHEN o.num_ric_dettaglio is null and o.num_ric_ingrosso is not null THEN 'Commercio ingrosso farmaci' END AS tipologia from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_OSM =  select cu.problem, o.site_id as id_asl,asl.description as descr_asl, o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, cu.ispezione_altro as altro_motivo_ispezione, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante,case when o.tipologia=800 then lao.description::text when o.tipologia =801 then laor.description::text else 'ND' end as tipologia,  oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o  LEFT JOIN lookup_attivita_osm lao on (o.impianto=lao.code) LEFT JOIN lookup_attivita_osm_reg laor on (o.impianto=laor.code) LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid =?
#GET_CONTROLLO_SOA =select distinct o.site_id as id_asl, cu.problem, asl.description as descr_asl,  o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, oa5.city as comune, oa5.addrline1 as indirizzo, (lacu.linea_attivita_stabilimenti_soa_desc || ' - ' || lacu.linea_attivita_stabilimenti_soa)as tipologia from lookup_site_id asl,ticket cu join organization o on o.org_id = cu.org_id LEFT JOIN soa_sottoattivita sa on  o.org_id = sa.id_soa LEFT JOIN linee_attivita_controlli_ufficiali_stab_soa lacu on  lacu.id_controllo_ufficiale =cu.ticketid LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and lacu.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_API = select sogg.nome as nome_rappresentante, sogg.cognome as cognome_rappresentante,sogg.data_nascita as data_nascita_rappresentante,sogg.comune_nascita as luogo_nascita_rappresentante,indsogg.via as indirizzo, indsogg.comune_testo as comune,cu.problem, o.id_asl as id_asl, asl.description as descr_asl, op.ragione_sociale as ragione_sociale, op.partita_iva as codice_fiscale, op.codice_azienda as n_reg, '' as approval_number, '' as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto,  cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci,com.nome as sede_legale,comsogg.nome as citta_legale_rapp,indsogg.via as indirizzo_legale_rapp, indsogg.provincia as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.via as indirizzo_legale,sogg.nome as nome_rapp_stab, sogg.cognome as cognome_rapp_stab, sogg.comune_nascita, op.domicilio_digitale as domicilio_digitale, sogg.data_nascita, '' as tipologia,  comsogg.nome as comune_stab,indsogg.via as indirizzo_stab from ticket cu join lookup_site_id asl on cu.site_id = asl.code join  apicoltura_apiari o on cu.id_apiario = o.id join apicoltura_imprese op on o.id_operatore = op.id join apicoltura_rel_impresa_soggetto_fisico rosf on rosf.id_apicoltura_imprese=op.id join opu_soggetto_fisico sogg on sogg.id = rosf.id_soggetto_fisico left join opu_indirizzo indsogg on indsogg.id = sogg.indirizzo_id left join comuni1 comsogg on comsogg.id = indsogg.comune left join apicoltura_relazione_imprese_sede_legale ros on ros.id_apicoltura_imprese = op.id and ros.enabled left join opu_indirizzo oa1 on oa1.id = ros.id_indirizzo left join comuni1 com on com.id = oa1.comune  where cu.ticketid = ?
GET_CONTROLLO_CANILE = select cu.problem, o.site_id as id_asl,asl.description as descr_asl, o.domicilio_digitale as domicilio_digitale,  o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.tipo_dest as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 10 THEN 'Canile'ELSE 'ND'END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_AZIENDE_AGRICOLE = select cu.problem, o.site_id as id_asl,asl.description as descr_asl,  o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, coalesce(o.codice_fiscale,o.partita_iva) as codice_fiscale, o.account_number as n_reg, o.alert as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 7 THEN 'AZIENDA AGRICOLA'ELSE 'ND' END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_ACQUE_DI_RETE = select cu.problem, o.site_id as id_asl,asl.description as descr_asl,  o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, coalesce(o.codice_fiscale,o.partita_iva) as codice_fiscale, o.account_number as n_reg, o.alert as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 14 THEN 'ACQUA DI RETE'ELSE 'ND' END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_RIPRODUZIONE_ANIMALE = select cu.problem, o.site_id as id_asl,asl.description as descr_asl,  o.domicilio_digitale as domicilio_digitale,  o.name as ragione_sociale, coalesce(o.codice_fiscale,o.partita_iva) as codice_fiscale, o.numaut as n_reg, o.alert as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 8 THEN 'RIPRODUZIONE ANIMALE' ELSE 'ND' END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_LAB_HACCP = select cu.problem, o.site_id as id_asl,asl.description as descr_asl,  o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.tipo_dest as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 152 THEN 'Laboratori HACCP'  WHEN o.tipologia = 10 THEN 'Canile'ELSE 'ND'END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ? 
GET_CONTROLLO_OPERATORI_SPERIMENTAZIONE_ANIMALE = select cu.problem, o.site_id as id_asl,asl.description as descr_asl,  o.domicilio_digitale as domicilio_digitale, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as approval_number , o.aut_utilizzo as n_reg, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 152 THEN 'Laboratori HACCP' WHEN o.tipologia = 850 THEN 'Sperimentazione Animale'  WHEN o.tipologia = 10 THEN 'Canile'ELSE 'ND'END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_ABUSIVI= select cu.problem, o.site_id as id_asl, asl.description as descr_asl, o.name as ragione_sociale,  o.domicilio_digitale as domicilio_digitale,  o.partita_iva as codice_fiscale, o.account_number as n_reg, o.tipo_dest as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 4 THEN 'Operatore abusivo' ELSE 'ND' END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id and oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_PRIVATI = select cu.problem, o.asl_rif as id_asl,o.asl as descr_asl, o.ragione_sociale as ragione_sociale,  '' as domicilio_digitale, o.partita_iva as codice_fiscale, o.num_riconoscimento as n_reg, o.num_riconoscimento as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,o.comune_leg as sede_legale, c.nome as citta_legale_rapp, concat(t.description, ' ', indsf.via, ', ', indsf.civico) as indirizzo_legale_rapp, p.description as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, o.indirizzo_leg as indirizzo_legale, o.nominativo_rappresentante as nome_rappresentante, '' as cognome_rappresentante, sf.comune_nascita as luogo_nascita_rappresentante, sf.data_nascita as data_nascita_rappresentante, 'Operatore Privato'  AS tipologia,o.comune as comune, o.indirizzo as indirizzo from ticket cu left join ricerche_anagrafiche_old_materializzata o on o.riferimento_id = cu.alt_id and o.riferimento_id_nome_tab = 'stabilimenti' left join anagrafica.stabilimenti s on s.alt_id = o.riferimento_id left join anagrafica.rel_imprese_stabilimenti relis on relis.id_stabilimento = s.id and relis.data_scadenza is null and relis.data_cancellazione is null left join anagrafica.rel_imprese_soggetti_fisici relisf on relisf.id_impresa = relis.id_impresa and relisf.data_scadenza is null and relisf.data_cancellazione is null left join anagrafica.soggetti_fisici sf on sf.id = relisf.id_soggetto_fisico left join anagrafica.rel_soggetti_fisici_indirizzi relisfind on relisfind.id_soggetto_fisico = relisf.id_soggetto_fisico and relisfind.data_scadenza is null and relisfind.data_cancellazione is null left join anagrafica.indirizzi indsf on indsf.id = relisfind.id_indirizzo left join anagrafica.comuni c on c.id = indsf.comune left join anagrafica.lookup_province p on p.code = indsf.provincia left join anagrafica.lookup_toponimi t on t.code = indsf.toponimo where cu.ticketid = ?
GET_CONTROLLO_OP_COMMERCIALI= select cu.problem, o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale,  o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 20 THEN 'Operatore Commerciale' ELSE 'ND' END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id and oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_OP_FUORI_ASL = select cu.problem, cu.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale,  o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 22 THEN 'Attivita'' Mobili Fuori Ambito ASL ' ELSE 'ND' END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id and oa1.address_type = 1 where cu.org_id = o.org_id and cu.site_id = asl.code and o.trashed_date is null and cu.ticketid = ? 
GET_CONTROLLO_OP_ABUSIVO = select cu.problem, o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale,  o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante,CASE WHEN o.alert is null THEN 'Distributore Automatico' ELSE o.alert END AS tipologia,oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id and oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_ALLEVAMENTI = select cu.problem, o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale,  o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due,cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette,cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp,o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale,data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante,o.data_nascita_rappresentante, o.tipologia_strutt AS tipologia,comuni.comune as comune, oa5.indrizzo_azienda as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN aziende oa5 ON oa5.cod_azienda = o.account_number LEFT JOIN comuni on comuni.codiceistatcomune = oa5.cod_comune_azienda LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id and oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_TRASPORTO = select cu.problem,  cu.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale,  o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, 'TRASPORTO ANIMALI ' || o.duns_type as tipologia, oa5.city as comune,oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and cu.site_id = asl.code and o.trashed_date is null and cu.ticketid= ?
GET_CONTROLLO_CANI_PADRONALI = select  cu.problem,  cu.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale,  o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.tipo_dest as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp,o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.name as nome_rappresentante, CASE WHEN o.tipologia = 255 THEN '' ELSE '' END as cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 255 THEN 'OPERATORE PRIVATO' ELSE 'ND' END AS tipologia, oa5.city as comune, oa5.addrline1 as indirizzo from organization o JOIN ticket cu ON (o.org_id = cu.org_id) LEFT JOIN lookup_site_id asl ON cu.site_id = asl.code LEFT JOIN lookup_tipo_controllo_cani_padronali ltcu ON cu.tipologia_controllo_cani = ltcu.code LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_OPERATORI_NON_ALTROVE = select  cu.problem,  o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale,  o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, 'TRASPORTO ANIMALI ' || o.duns_type as tipologia, oa5.city as comune,oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid= ?
GET_CONTROLLO_IMBARCAZIONE =  select cu.problem,  o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.domicilio_digitale as domicilio_digitale, o.data_nascita_rappresentante, o.alert as tipologia, CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.city WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.city WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.city END AS comune, CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.addrline1 WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.addrline1 WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.addrline1 END AS indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid= ?
GET_CONTROLLO_ANAGRAFICA = select distinct sogg.nome as nome_rappresentante, sogg.cognome as cognome_rappresentante,sogg.data_nascita as data_nascita_rappresentante,sogg.comune_nascita as luogo_nascita_rappresentante,indstab.via as indirizzo, comstab.nome as comune,cu.problem, stab.id_asl as id_asl,asl.description as descr_asl, op.ragione_sociale as ragione_sociale, op.partita_iva as codice_fiscale, stab.numero_registrazione as n_reg, stab.numero_registrazione as approval_number, '' as tipo_impresa, cu.location as num_verbale, cu.assigned_date as data_referto,  cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque,  cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, com.nome as sede_legale,comsogg.nome as citta_legale_rapp,indsogg.via as indirizzo_legale_rapp, indsogg.provincia as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, CASE WHEN oa1.via='' THEN indsogg.via  ELSE oa1.via  END AS indirizzo_legale,soggstab.nome as nome_rapp_stab, soggstab.cognome as cognome_rapp_stab, soggstab.comune_nascita, op.domicilio_digitale as domicilio_digitale, soggstab.data_nascita, ml8.attivita as tipologia,  comstab.nome as comune_Stab,  indstab.via as indirizzo_stab  from ticket cu join lookup_site_id asl on asl.code = cu.site_id join opu_stabilimento stab on stab.alt_id = cu.alt_id join opu_operatore op on stab.id_operatore = op.id join opu_rel_operatore_soggetto_fisico rosf on rosf.id_operatore=op.id and rosf.enabled join opu_soggetto_fisico sogg on sogg.id = rosf.id_soggetto_fisico left join opu_indirizzo indsogg on indsogg.id = sogg.indirizzo_id left join comuni1 comsogg on comsogg.id = indsogg.comune  left join opu_indirizzo oa1 on oa1.id = op.id_indirizzo left join comuni1 com on com.id = oa1.comune left join opu_indirizzo indstab on indstab.id = stab.id_indirizzo join comuni1 comstab on comstab.id = indstab.comune left join opu_soggetto_fisico soggstab on soggstab.id = stab.id_soggetto_fisico left join linee_attivita_controlli_ufficiali lacu on lacu.id_controllo_ufficiale = cu.ticketid and lacu.trashed_date is null left join opu_relazione_stabilimento_linee_produttive rel on rel.id = lacu.id_linea_attivita left join ml8_linee_attivita_nuove_materializzata ml8 on ml8.id_nuova_linea_attivita = rel.id_linea_produttiva where cu.alt_id = stab.alt_id and stab.id_asl = asl.code and cu.ticketid= ?  
GET_CONTROLLO_ZONE_CONTROLLO = select cu.problem, o.site_id as id_asl, asl.description as descr_asl, o.name as ragione_sociale, o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 15 THEN 'ZONE DI CONTROLLO' ELSE 'ND' END AS tipologia, oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id and oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?
GET_CONTROLLO_PUNTI_DI_SBARCO = select cu.problem, o.site_id as id_asl, asl.description as descr_asl, o.name as ragione_sociale, o.domicilio_digitale as domicilio_digitale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, cu.location as num_verbale, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove,cu.componente_nucleo_dieci,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, cu.ticketid as id_controllo_ufficiale, data_fine_controllo, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, CASE WHEN o.tipologia = 5 THEN 'PUNTI DI SBARCO' ELSE 'ND' END AS tipologia, oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl,ticket cu, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id and oa1.address_type = 1 where cu.org_id = o.org_id and o.site_id = asl.code and o.trashed_date is null and cu.ticketid = ?

GET_CAMPIONE = select distinct cu.ticketid as idControllo, campioni.closed as data_chiusura_campione, o.site_id as id_asl,asl.description as descr_asl, coalesce(o.name,op.ragione_sociale) as ragione_sociale, coalesce(o.partita_iva,op.partita_iva) as codice_fiscale, coalesce(o.account_number,opus.numero_registrazione) as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, cu.location as num_verbale, case when piani.description is not null then piani.description else l.description end as piano,campioni.motivazione, l.description as motivazione, piani.code as codice_piano, coalesce(campioni.motivazione_campione,campioni.motivazione_piano_campione) as motivazione_campione, case when campioni.motivazione_piano_campione is not null then piani.codice_esame else l.codice_esame end as barcode_motivazione, cu.assigned_date as data_referto, cu.componente_nucleo, cu.componente_nucleo_due, cu.componente_nucleo_tre, cu.componente_nucleo_quattro, cu.componente_nucleo_cinque, cu.componente_nucleo_sei, cu.componente_nucleo_sette, cu.componente_nucleo_otto, cu.componente_nucleo_nove, cu.componente_nucleo_dieci, coalesce(oa1.city,comimp.nome) as sede_legale, coalesce(o.city_legale_rapp ,comune_nascita)as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp,o.prov_legale_rapp as provincia_legale_rapp,cu.ticketid as id_controllo_ufficiale,cu.data_fine_controllo, oa1.addrline1 as indirizzo_legale, coalesce((o.nome_rappresentante || ' ' || o.cognome_rappresentante),(sogg.nome || ' ' || sogg.cognome)) as nome_rappresentante, coalesce (o.luogo_nascita_rappresentante,sogg.comune_nascita) as luogo_nascita_rappresentante, a.nome as analita, m.nome as matrice,o.data_nascita_rappresentante,  o.alert as tipologia, CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.city WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.city  WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.city END AS comune, CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.addrline1 WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.addrline1 WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.addrline1 END AS indirizzo from lookup_site_id asl join ticket cu  on cu.site_id = asl.code join ticket campioni on campioni.id_controllo_ufficiale = cu.id_controllo_ufficiale and campioni.tipologia = 2 and cu.tipologia =3 left join analiti_campioni ac on ac.id_campione = campioni.ticketid left join analiti a on a.analiti_id = ac.analiti_id left join matrici_campioni mc on mc.id_campione = campioni.ticketid left join matrici m on m.matrice_id = mc.id_matrice  left join lookup_tipo_ispezione l on l.code = campioni.motivazione_campione  left join lookup_piano_monitoraggio piani on piani.code = campioni.motivazione_piano_campione left join organization o on cu.org_id = o.org_id and o.trashed_date is null and o.site_id = cu.site_id left join opu_stabilimento opus on opus.id = cu.id_stabilimento left join opu_soggetto_fisico sogg on sogg.id = opus.id_soggetto_fisico left join opu_indirizzo  indstab on indstab.id = opus.id_indirizzo left join comuni1 comstab on comstab.id = indstab.comune left join opu_operatore op on op.id = opus.id_operatore left join opu_indirizzo indimp on indimp.id = opus.id_indirizzo left join comuni1 comimp on comimp.id = indimp.comune LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where campioni.ticketid= ?
GET_DATI_UTENTE = select servizio, mail, id_controllo, flag, gravi, uo, via_amm, presente_ispezione, luogo_nascita, giorno_nascita,mese_nascita, anno_nascita, luogo_residenza, luogo_residenza_ispezione, via_ispezione, civico_ispezione,doc_identita, strumenti_ispezione, desc_risoluzione, indirizzo_legale_rappresentante, num_civico_rappresentante, desc_risoluzione_iniz, dichiarazione, responsabile, note, n_copie,luogo_partenza_trasporto, nazione_partenza_trasporto, data_partenza_trasporto, ora_partenza_trasporto,destinazione_trasporto, nazione_destinazione_trasporto, data_arrivo_trasporto, ora_arrivo_trasporto,certificato_trasporto, data_certificato_trasporto, luogo_rilascio_trasporto, ore, num_campioni from dati_utente_controlliufficiali where id_controllo = ?
GET_DATI_IMPRESA = select o.site_id as id_asl, asl.description as descr_asl, o.name as ragione_sociale, o.partita_iva as partita_iva, o.codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp,o.prov_legale_rapp as provincia_legale_rapp, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante || ' ' || o.cognome_rappresentante as nome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, o.alert as tipologia_attivita,CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.city WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.city WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.city END AS comune,CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.addrline1 WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.addrline1 WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.addrline1 END AS indirizzo from organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 LEFT JOIN lookup_site_id asl ON o.site_id = asl.code where o.trashed_date is null and o.org_id= ?
GET_TAMPONE = select tamponi.ticketid, cu.ticketid as idCU, tamponi.provvedimenti_prescrittivi, ldt.description as dest_tampone, tamponi.sanzioni_amministrative, let.description as esito_tampone, tamponi.sanzioni_penali, ltt.description as tipo_tampone from ticket cu join ticket tamponi on tamponi.id_controllo_ufficiale = cu.id_controllo_ufficiale LEFT JOIN lookup_destinazione_tampone ldt on ldt.code = tamponi.sanzioni_penali LEFT JOIN lookup_esito_tampone let on let.code = tamponi.sanzioni_amministrative LEFT JOIN lookup_tipo_tampone ltt on ltt.code = tamponi.provvedimenti_prescrittivi where tamponi.tipologia = 7 and cu.tipologia = 3 and cu.trashed_date is null and tamponi.trashed_date is null and tamponi.ticketid= ?
GET_TAMPONE_SEDUTA_MACELLAZIONE = select  tamponi.id , carcasse.description as descrizioneTipoCarcassa ,p.description as descrizionePianoMonitoraggio , tamponi.id_Tipo_Carcassa as idTipoCarcassa,tamponi.piano_monitoraggio as idPianoMonitoraggio ,tamponi.data_macellazione as dataMAcellazione,tamponi.sessione_macellazione as sessioneMacellazione,tamponi.id_macello as idMacello,distruttivo from m_vpm_tamponi tamponi left join lookup_piano_monitoraggio p on p.code = tamponi.piano_monitoraggio join lookup_tamponi carcasse on tamponi.id_tipo_carcassa = carcasse.code 

GET_OP_SIN = select * from view_operatori_sin where org_id = ?
GET_OP_PNAA = select * from view_operatori_pnaa where  org_id = ? and id_campione = ? 
GET_OP_PNAA_2 = select * from view_operatori_pnaa_modificata where  org_id = ? and id_campione = ? 
#Per ora la query di impresa e allevamenti e' uguale...
GET_DATI = select o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale, o.partita_iva as partita_iva, coalesce(o.partita_iva,o.codice_fiscale) as codice_fiscale, coalesce(o.account_number,o.numaut) as n_reg, o.tipo_dest as tipo_impresa, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp,o.prov_legale_rapp as provincia_legale_rapp, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, o.alert as tipologia, coalesce(oa5.city,oa1.city) as comune,coalesce(oa5.addrline1,oa1.addrline1) as indirizzo from organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 LEFT JOIN lookup_site_id asl ON o.site_id = asl.code where o.trashed_date is null and o.org_id = ?
GET_DATI_ALLEVAMENTO = select o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale, o.partita_iva as partita_iva, o.codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa, oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp,o.prov_legale_rapp as provincia_legale_rapp, oa1.addrline1 as indirizzo_legale, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, o.alert as tipologia, CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.city WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.city WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.city END AS comune,CASE WHEN o.tipo_dest::text = 'Es. Commerciale'::text THEN oa5.addrline1 WHEN o.tipo_dest::text = 'Autoveicolo'::text THEN oa1.addrline1 WHEN o.tipo_dest::text = 'Distributori'::text THEN oa1.addrline1 END AS indirizzo from organization o  LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 LEFT JOIN lookup_site_id asl ON o.site_id = asl.code where o.trashed_date is null and o.org_id= ?
GET_DATI_STABILIMENTO = select o.site_id as id_asl, asl.description as descr_asl,o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, sa.codice_impianto, sa.codice_sezione, o.tipo_dest as tipo_impresa,oa1.city as sede_legale, oa1.addrline1 as indirizzo_legale, oa5.city as comune, oa5.addrline1 as indirizzo, (l.description || ' ' || sa.attivita )as tipologia_attivita FROM organization o LEFT join lookup_site_id asl ON o.site_id = asl.code LEFT JOIN stabilimenti_sottoattivita sa on  o.org_id = sa.id_stabilimento LEFT JOIN lookup_categoria l on  sa.codice_sezione = l.code LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where o.site_id = asl.code and o.trashed_date is null and o.impianto = sa.codice_impianto and o.org_id = ?
GET_DATI_SOA = select distinct(sa.attivita ) as tipologia, o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, o.tipo_dest as tipo_impresa,oa1.city as sede_legale, o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, oa1.addrline1 as indirizzo_legale,o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante, oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl, organization o LEFT JOIN soa_sottoattivita sa on o.org_id = sa.id_soa LEFT JOIN lookup_categoria_soa l on  sa.codice_sezione = l.code LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN organization_address oa1 ON oa1.org_id = o.org_id AND oa1.address_type = 1 where o.site_id = asl.code and o.trashed_date is null and o.codice_impianto = cast(sa.codice_impianto as text) and o.org_id = ?
GET_DATI_OSM = select  o.site_id as id_asl,asl.description as descr_asl, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg,o.numaut as approval_number,o.city_legale_rapp as citta_legale_rapp, o.address_legale_rapp as indirizzo_legale_rapp, o.prov_legale_rapp as provincia_legale_rapp, o.nome_rappresentante, o.cognome_rappresentante, o.luogo_nascita_rappresentante, o.data_nascita_rappresentante,case when o.tipologia=800 then lao.description::text when o.tipologia =801 then laor.description::text else 'ND' end as tipologia,  oa5.city as comune, oa5.addrline1 as indirizzo from lookup_site_id asl, organization o  LEFT JOIN lookup_attivita_osm lao on (o.impianto=lao.code) LEFT JOIN lookup_attivita_osm_reg laor on (o.impianto=laor.code) LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 where o.site_id = asl.code and o.trashed_date is null and o.org_id = ?
#select distinct(o.site_id) as id_asl,CASE WHEN o.taxid is not null then o.taxid WHEN o.taxid is null and o.impianto > 0 then a.description END AS tipologia, l.description as descr_asl, o.name as ragione_sociale, o.partita_iva as codice_fiscale, o.account_number as n_reg, o.numaut as approval_number, oa5.city as comune, oa5.addrline1 as indirizzo from lookup_impianto_osm i, lookup_attivita_osm a, organization o LEFT JOIN organization_address oa5 ON oa5.org_id = o.org_id AND oa5.address_type = 5 LEFT JOIN lookup_site_id l on l.code = o.site_id where o.trashed_date is null and o.org_id = ?  
#o.impianto = i.code#

### QUERY PER LE STAMPE TRASPORTO ANIMALI ###
#GET_ALLEGATO_C = select o.*,oa.*, at1.description as d1,at2.description as d2, at3.description as d3,at4.description as d4, at5.description as d5,at6.description as d6, at10.description as d10 from organization as o left join organization_address as oa on (o.org_id = oa.org_id and oa.address_type=1) left join animalitrasportati as at on (o.org_id = at.org_id and at.tipo_animale =1) left join animalitrasportati as ata on (o.org_id = ata.org_id and ata.tipo_animale =2) left join animalitrasportati as ats on (o.org_id = ats.org_id and ats.tipo_animale =3) left join animalitrasportati as atd on (o.org_id = atd.org_id and atd.tipo_animale =4) left join animalitrasportati as atf on (o.org_id = atf.org_id and atf.tipo_animale =5) left join animalitrasportati as atp on (o.org_id = atp.org_id and atp.tipo_animale =6) left join animalitrasportati as atbuf on (o.org_id = atbuf.org_id and atbuf.tipo_animale =10) left join lookup_specie_trasportata as at1 on (at.tipo_animale = at1.code and at1.code = 1) left join lookup_specie_trasportata as at2 on (ata.tipo_animale = at2.code and at2.code = 2) left join lookup_specie_trasportata as at3 on (ats.tipo_animale = at3.code and at3.code =3) left join lookup_specie_trasportata as at4 on (atd.tipo_animale = at4.code and at4.code =4) left join lookup_specie_trasportata as at5 on (atf.tipo_animale = at5.code and at5.code =5) left join lookup_specie_trasportata as at6 on (atp.tipo_animale = at6.code and at6.code =6) left join lookup_specie_trasportata as at10 on (atbuf.tipo_animale = at10.code and at10.code =10) where o.org_id = ? and o.trashed_date is null
GET_ALLEGATO_C_OP = select o.*,  'Mod. Rev. ' ||  to_char(now(), 'dd-mm-yyyy') as data_rev,oa.address_id, oa.address_type, oa.addrline1, oa.city, oa.state, oa.postalcode, oa.country, oa.latitude, oa.longitude from organization as o  left join organization_address as oa on (o.org_id = oa.org_id and oa.address_type=1)  where o.org_id = ? and o.trashed_date is null;
GET_ALLEGATO_SP = select at1.description as d1 ,o.codice10 from organization as o left join animalitrasportati as at on (o.org_id = at.org_id) left join lookup_specie_trasportata as at1 on (at.tipo_animale = at1.code) where o.org_id = ? and o.trashed_date is null;
GET_ALLEGATO_D = select o.*,oa.*,  'Mod. Rev. ' ||  to_char(now(), 'dd-mm-yyyy') as data_rev, at1.description as d1,at2.description as d2, at3.description as d3,at4.description as d4, at5.description as d5,at6.description as d6, at10.description as d10 from organization as o left join organization_address as oa on (o.org_id = oa.org_id and oa.address_type=1) left join animalitrasportati as at on (o.org_id = at.org_id and at.tipo_animale =1) left join animalitrasportati as ata on (o.org_id = ata.org_id and ata.tipo_animale =2) left join animalitrasportati as ats on (o.org_id = ats.org_id and ats.tipo_animale =3) left join animalitrasportati as atd on (o.org_id = atd.org_id and atd.tipo_animale =4) left join animalitrasportati as atf on (o.org_id = atf.org_id and atf.tipo_animale =5) left join animalitrasportati as atp on (o.org_id = atp.org_id and atp.tipo_animale =6) left join animalitrasportati as atbuf on (o.org_id = atbuf.org_id and atbuf.tipo_animale =10) left join lookup_specie_trasportata as at1 on (at.tipo_animale = at1.code and at1.code = 1) left join lookup_specie_trasportata as at2 on (ata.tipo_animale = at2.code and at2.code = 2) left join lookup_specie_trasportata as at3 on (ats.tipo_animale = at3.code and at3.code =3) left join lookup_specie_trasportata as at4 on (atd.tipo_animale = at4.code and at4.code =4) left join lookup_specie_trasportata as at5 on (atf.tipo_animale = at5.code and at5.code =5) left join lookup_specie_trasportata as at6 on (atp.tipo_animale = at6.code and at6.code =6) left join lookup_specie_trasportata as at10 on (atbuf.tipo_animale = at10.code and at10.code =10) where o.org_id = ? and o.trashed_date is null
GET_ALLEGATO_G = select distinct o.*, 'Mod. Rev. ' ||  to_char(now(), 'dd-mm-yyyy') as data_rev, asl.description as asl,auto.targa,auto.descrizione as mezzo, asl.description as asl, oa.*,at1.description as d1,at2.description as d2, at3.description as d3,at4.description as d4, at5.description as d5,at6.description as d6, at10.description as d10 from organization as o join organization_address as oa on (o.org_id = oa.org_id and oa.address_type=1) left join lookup_site_id as asl on (o.site_id = asl.code) left join animalitrasportati as at on (o.org_id = at.org_id and at.tipo_animale =1) left join animalitrasportati as ata on (o.org_id = ata.org_id and ata.tipo_animale =2) left join animalitrasportati as ats on (o.org_id = ats.org_id and ats.tipo_animale =3) left join animalitrasportati as atd on (o.org_id = atd.org_id and atd.tipo_animale =4) left join animalitrasportati as atf on (o.org_id = atf.org_id and atf.tipo_animale =5) left join animalitrasportati as atp on (o.org_id = atp.org_id and atp.tipo_animale =6) left join animalitrasportati as atbuf on (o.org_id = atbuf.org_id and atbuf.tipo_animale =10) left join lookup_specie_trasportata as at1 on (at.tipo_animale = at1.code and at1.code = 1) left join lookup_specie_trasportata as at2 on (ata.tipo_animale = at2.code and at2.code = 2) left join lookup_specie_trasportata as at3 on (ats.tipo_animale = at3.code and at3.code =3) left join lookup_specie_trasportata as at4 on (atd.tipo_animale = at4.code and at4.code =4) left join lookup_specie_trasportata as at5 on (atf.tipo_animale = at5.code and at5.code =5) left join lookup_specie_trasportata as at6 on (atp.tipo_animale = at6.code and at6.code =6) left join lookup_specie_trasportata as at10 on (atbuf.tipo_animale = at10.code and at10.code =10) left join organization_autoveicoli as auto on (o.org_id = auto.org_id and auto.elimina is null) where o.org_id = ?  and o.trashed_date is null;
#GET_ALLEGATO_H = select distinct oa.*, o.*,  'Mod. Rev. ' ||  to_char(now(), 'dd-mm-yyyy') as data_rev, auto.targa,auto.descrizione as mezzo, asl.description as asl,oa2.addrline1 as sede,oa2.state as statesede, oa2.city as cittasede,at1.description as d1,at2.description as d2, at3.description as d3 from organization as o join organization_address as oa on (o.org_id = oa.org_id and oa.address_type=1) join organization_address as oa2 on (o.org_id = oa2.org_id and oa2.address_type=5) left join lookup_site_id as asl on (o.site_id = asl.code) left join animalitrasportati as at on (o.org_id = at.org_id and at.tipo_animale =7) left join animalitrasportati as ata on (o.org_id = ata.org_id and ata.tipo_animale =8) left join animalitrasportati as ats on (o.org_id = ats.org_id and ats.tipo_animale =9) left join lookup_specie_trasportata as at1 on (at.tipo_animale = at1.code and at1.code = 7) left join lookup_specie_trasportata as at2 on (ata.tipo_animale = at2.code and at2.code = 8) left join lookup_specie_trasportata as at3 on (ats.tipo_animale = at3.code and at3.code =9) join organization_autoveicoli as auto on (o.org_id = auto.org_id) and auto.elimina is null where o.org_id = ? and o.trashed_date is null
GET_ALLEGATO_H = select distinct oa.*, o.*,  'Mod. Rev. ' ||  to_char(now(), 'dd-mm-yyyy') as data_rev, (select string_agg(targa, ' - ') from organization_autoveicoli auto where auto.elimina is null and org_id = ?) as targa, (select string_agg(descrizione, ' - ') from organization_autoveicoli auto where auto.elimina is null and org_id = ?) as mezzo, asl.description as asl,oa2.addrline1 as sede,oa2.state as statesede, oa2.city as cittasede,at1.description as d1, at2.description as d2, at3.description as d3 from organization as o join organization_address as oa on (o.org_id = oa.org_id and oa.address_type=1) join organization_address as oa2 on (o.org_id = oa2.org_id and oa2.address_type=5) left join lookup_site_id as asl on (o.site_id = asl.code) left join animalitrasportati as at on (o.org_id = at.org_id and at.tipo_animale =7) left join animalitrasportati as ata on (o.org_id = ata.org_id and ata.tipo_animale =8) left join animalitrasportati as ats on (o.org_id = ats.org_id and ats.tipo_animale =9) left join lookup_specie_trasportata as at1 on (at.tipo_animale = at1.code and at1.code = 7) left join lookup_specie_trasportata as at2 on (ata.tipo_animale = at2.code and at2.code = 8) left join lookup_specie_trasportata as at3 on (ats.tipo_animale = at3.code and at3.code =9) where o.org_id = ? and o.trashed_date is null
GET_RENDICONTAZIONE_ANNUALE = select * from vista_rendicontazione_annuale_animali_trasportati where somma_animali_specie != 0 and anno_controllo_ufficiale = ? 
GET_RENDICONTAZIONE_ANNUALE_ISPEZIONI = select * from vista_rendicontazione_annuale_ispezioni where somma_animali_specie != 0 and anno_controllo_ufficiale = ?
GET_RENDICONTAZIONE_ANNUALE_VIOLAZIONI =  select * from vista_rendicontazione_annuale_violazioni where somma_animali != 0 and anno_controllo_ufficiale = ?
GET_RENDICONTAZIONE_ANNUALE_MEZZI = select * from vista_rendicontazione_annuale_numero_mezzi where anno_controllo_ufficiale = ?
GET_RENDICONTAZIONE_ANNUALE_MEZZI_VIOLAZIONI =  select * from vista_rendicontazione_annuale_mezzi_violazioni where anno_controllo_ufficiale = ?

### QUERY PER GESTIONE DELLE SCHEDE DEL BENESSERE IN AZIENDE ZOOTECNICHE
	GET_CHK_BNS_ALLEVAMENTO = SELECT l.description AS asl, o.org_id, t.ticketid as id_controllo_ufficiale, t.assigned_date as data_controllo, \
	t.closed as data_chiusura_controllo, o.name AS denominazione, o.account_number AS codice_azienda, o.codice_tipo_allevamento,  \
	o.id_allevamento, o.tipologia_strutt AS tipologia_struttura, o.orientamento_prod AS \
	orientamento_produttivo, specie.code as codice_specie, specie.description AS specie_allevata, o.date1 AS data_inizio_attivita, \
	o.partita_iva AS partita_iva_codice_fiscale,-1 as id_stabilimento, \
	case when o.tipologia = 2 then coalesce(op_detentore.cf,o.cf_correntista)  else o.codice_fiscale_rappresentante end AS cf_proprietario ,\
	coalesce (op_prop.nominativo,o.nome_rappresentante || ' '|| o.cognome_rappresentante ) AS proprietario, \
	case when o.tipologia = 2 then coalesce(op_detentore.cf, o.cf_detentore)   else o.codice_fiscale_rappresentante end AS cf_detentore, \
	coalesce (op_detentore.nominativo,o.nome_rappresentante || ' '|| o.cognome_rappresentante) AS detentore,  \
	oa5.city as comune_operativo,oa5.state as provincia_operativo , oa5.addrline1 as indirizzo_operativo, \
	az.indrizzo_azienda AS indirizzo_azienda, az.cap_azienda, com.comune AS comune_azienda, az.prov_sede_azienda, \
	oa.city as comune_legale, \
	oa.state as provincia_legale, \
	oa.postalcode as cap_legale, \
	case when oa.addrline1 is not null and oa.city is not null then oa.addrline1 || ' - ' || oa.city \
	when oa.addrline1 is not null and oa.city is null then oa.addrline1 \
	when oa.addrline1 is null and oa.city is not null then oa.city \
	end as indirizzo_legale, \
	CASE WHEN o.date2 IS NULL \
	THEN 'In Attivita'::text WHEN o.date2 IS NOT NULL THEN 'Cessato'::text \
	ELSE NULL::text END AS stato_allevamento FROM aziende az \
	right JOIN organization o ON o.account_number::text = az.cod_azienda \
	left join organization_address oa on oa.org_id = o.org_id and oa.address_type = 1 \
	left join organization_address oa5 on oa5.org_id = o.org_id and oa5.address_type = 5 \
	LEFT JOIN ticket t on t.org_id = o.org_id \
	LEFT JOIN comuni com ON az.cod_comune_azienda = com.codiceistatcomune::text \
	LEFT JOIN operatori_allevamenti op_detentore ON o.cf_correntista::text = op_detentore.cf \
	LEFT JOIN operatori_allevamenti op_prop ON o.codice_fiscale_rappresentante::text = op_prop.cf \
	LEFT JOIN lookup_specie_allevata specie ON o.specie_allevamento = specie.code \
	LEFT JOIN lookup_site_id l ON l.code = o.site_id WHERE o.org_id <> 0  \
	AND o.trashed_date IS NULL and o.org_id = ? and t.ticketid = ? \
  
  GET_CHK_BNS_ALLEVAMENTO_OPU = SELECT distinct on (ori.descrizione_tipo_produzione) ori.descrizione_tipo_produzione as tipologia_struttura, \
 o.stab_asl AS asl, o.id_stabilimento, t.ticketid as id_controllo_ufficiale, t.assigned_date as data_controllo, \
	t.closed as data_chiusura_controllo, o.ragione_sociale AS denominazione, \
	coalesce(o.linea_codice_nazionale, o.linea_codice_ufficiale_esistente) AS codice_azienda, \
	-1 as id_allevamento, \
	coalesce((regexp_split_to_array(o.path_attivita_completo, '->'))[4], '') as orientamento_produttivo, \
	-1 as codice_specie, o.solo_attivita as specie_allevata, o.data_inizio_attivita AS data_inizio_attivita, \
	o.partita_iva AS partita_iva_codice_fiscale,-1 as org_id, \
	o.cf_rapp_sede_legale AS cf_proprietario , \
	concat_ws(' ', o.nome_rapp_sede_legale,  o.cognome_rapp_sede_legale) AS proprietario, \
	'' AS cf_detentore, \
	'' AS detentore,  \
	o.indirizzo_stab as indirizzo_operativo, \
	o.indirizzo_stab AS indirizzo_azienda,o.cap_stab as cap_azienda, \
	o.comune_stab AS comune_azienda, \
	o.prov_stab as prov_sede_azienda, \
	o.comune_sede_legale as comune_legale, \
	o.prov_sede_legale as provincia_legale, \
	o.cap_sede_legale as cap_legale, \
	o.indirizzo_sede_legale as indirizzo_legale, \
	CASE WHEN o.data_fine_attivita IS NULL \
	THEN 'In Attivita'::text WHEN o.data_fine_attivita IS NOT NULL THEN 'Cessato'::text \
	ELSE NULL::text END AS stato_allevamento \
FROM opu_operatori_denormalizzati_view o \
	LEFT JOIN ticket t on t.id_stabilimento = o.id_stabilimento \
	JOIN linee_attivita_controlli_ufficiali olacu on olacu.id_controllo_ufficiale = t.ticketid \
	LEFT JOIN opu_relazione_stabilimento_linee_produttive rel on rel.id = olacu.id_linea_attivita \
	LEFT join ml8_linee_attivita_nuove_materializzata l on l.id_nuova_linea_attivita = rel.id_linea_produttiva \
	LEFT JOIN orientamenti_produttivi ori on l.decodifica_tipo_produzione_bdn = ori.tipo_produzione \
 	WHERE olacu.trashed_date is null and o.id_stabilimento <> 0 \
	AND o.id_stabilimento = ? and t.ticketid = ? 
	
GET_CHK_BNS_CAP = select cap.* from chk_bns_cap cap  left join lookup_chk_bns_mod la on la.code = cap.idmod where cap.enabled and la.codice_specie = ? \
AND la.versione = ? order by code

GET_CHK_BNS_DOM = select dom.* from \
chk_bns_dom dom  \
left join chk_bns_cap cap on cap.code = dom.idcap \
left join lookup_chk_bns_mod mod on mod.code = cap.idmod \
where dom.enabled and cap.enabled and mod.codice_specie = ? \
and mod.nuova_gestione = ? order by dom.level 

GET_CHK_BNS_DOM_BY_ID = select dom.* from \
chk_bns_dom dom  \
where dom.idcap = ? and dom.enabled order by dom.level 

#######################################################################

GET_BIOSICUREZZA_ALLEVAMENTO = select \
o.name as denominazione, \
o.account_number as codice_azienda, \
o.codice_fiscale_rappresentante as cf_proprietario, \
o.orientamento_prod as orientamento_produttivo, \
o.tipologia_strutt as tipologia_struttura, \
case when trim(a.localita) <> '' then a.localita else a.indrizzo_azienda end as indirizzo_azienda, \
a.latitudine, \
a.longitudine, \
c.nome as comune_azienda,\
a.prov_sede_azienda as prov_sede_azienda,\
asl.description as asl \
from organization o \
left join aziende a on upper(a.cod_azienda) = upper(o.account_number)::text \
left join comuni1 c on c.istat::integer = a.cod_comune_azienda::integer \
left join lookup_site_id asl on asl.code = c.codiceistatasl::integer \
where o.org_id = ?

GET_FARMACOSORVEGLIANZA_ALLEVAMENTO = select o.account_number as codice_azienda, o.codice_fiscale_rappresentante as cf_proprietario, o.cf_correntista as cf_detentore, o.orientamento_prod as orientamento_produttivo, o.tipologia_strutt as tipologia_struttura, a.indrizzo_azienda as indirizzo_azienda, concat(oalegtop.description, ' ', oaleg.addrline1, ', ', oaleg.civico, ' ', oaleg.city)  as indirizzo_legale, a.latitudine, a.longitudine, c.nome as comune_azienda, asl.description as asl, o.name as denominazione, prop.nominativo as nome_proprietario, det.nominativo as nome_detentore, o.specie_allev as specie_allevata from organization o \
left join aziende a on a.cod_azienda = o.account_number \
left join comuni1 c on c.istat::integer = a.cod_comune_azienda::integer \
left join organization_address oaleg on (o.org_id = oaleg.org_id and oaleg.address_type = 1 and oaleg.trasheddate is null) \
left join lookup_toponimi oalegtop on oalegtop.code = oaleg.toponimo \
left join lookup_site_id asl on asl.code = c.codiceistatasl::integer \
left join operatori_allevamenti prop on o.codice_fiscale_rappresentante = prop.cf \
left join operatori_allevamenti det on o.cf_correntista = det.cf \
where o.org_id = ?
 
GET_RENDICONTAZIONE = select appoggio.anno,\
coalesce( t_bovini_ispezionati_macello.sum, 0 )as n_bovini_ispezionati_macello,\
coalesce( t_bovini_ispezionati_esportazione.sum, 0 )as n_bovini_ispezionati_esportazione,\
coalesce( t_bovini_ispezionati_importati.sum, 0 )as n_bovini_ispezionati_importati, /*Bovini importati CD*/                    \
coalesce( t_bovini_ispezionati_altro.sum, 0 )as n_bovini_ispezionati_altro, /*Bovini da altro CD*/                          \
coalesce( t_suini_ispezionati_macello.sum, 0 )as n_suini_ispezionati_macello, /*Suini da macello CD*/                        \
coalesce( t_suini_ispezionati_esportazione.sum, 0 )as n_suini_ispezionati_esportazione, /*Suini da esportazione CD*/              \
coalesce( t_suini_ispezionati_importati.sum, 0 )as n_suini_ispezionati_importati, /*Suini importati CD*/                      \
coalesce( t_suini_ispezionati_altro.sum, 0 )as n_suini_ispezionati_altro, /*Suini da altro CD*/                            \
coalesce( t_piccoli_ispezionati_macello.sum, 0 )as n_piccoli_ispezionati_macello, /*Piccoli Ruminanti da macello CD*/          \
coalesce( t_piccoli_ispezionati_esportazione.sum, 0 )as n_piccoli_ispezionati_esportazione, /*Piccoli Ruminanti da esportazione CD*/\
coalesce( t_piccoli_ispezionati_importati.sum, 0 )as n_piccoli_ispezionati_importati, /*Piccoli Ruminanti importati CD*/        \
coalesce( t_piccoli_ispezionati_altro.sum, 0 )as n_piccoli_ispezionati_altro, /*Piccoli Ruminanti da altro CD*/              \
coalesce( t_equidi_ispezionati_macello.sum, 0 )as n_equidi_ispezionati_macello, /*Equidi da macello CD*/                      \
coalesce( t_equidi_ispezionati_esportazione.sum, 0 )as n_equidi_ispezionati_esportazione, /*Equidi da esportazione CD*/            \
coalesce( t_equidi_ispezionati_importati.sum, 0 )as n_equidi_ispezionati_importati, /*Equidi importati CD*/                    \
coalesce( t_equidi_ispezionati_altro.sum, 0 )as n_equidi_ispezionati_altro, /*Equidi da altro CD*/                          \
coalesce( t_volatili_ispezionati_macello.sum, 0 )as n_volatili_ispezionati_macello, /*Volatili da macello CD*/                  \
coalesce( t_volatili_ispezionati_esportazione.sum, 0 )as n_volatili_ispezionati_esportazione, /*Volatili da esportazione CD*/        \
coalesce( t_volatili_ispezionati_importati.sum, 0 )as n_volatili_ispezionati_importati, /*Volatili importati CD*/                \
coalesce( t_volatili_ispezionati_altro.sum, 0 )as n_volatili_ispezionati_altro, /*Volatili da altro CD*/                      \
coalesce( t_altre_ispezionati_macello.sum, 0 )as n_altre_ispezionati_macello, /*Altre da macello CD*/                        \
coalesce( t_altre_ispezionati_esportazione.sum, 0 )as n_altre_ispezionati_esportazione, /*Altre da esportazione CD*/              \
coalesce( t_altre_ispezionati_importati.sum, 0 )as n_altre_ispezionati_importati, /*Altre importati CD*/                      \
coalesce( t_altre_ispezionati_altro.sum, 0 )as n_altre_ispezionati_altro, /*Altre da altro CD*/                            \
coalesce( t_buf_ispezionati_macello.sum, 0 )as n_buf_ispezionati_macello, /*Buf da macello CD*/                          \
coalesce( t_buf_ispezionati_esportazione.sum, 0 )as n_buf_ispezionati_esportazione, /*Buf da esportazione CD*/                \
coalesce( t_buf_ispezionati_importati.sum, 0 )as n_buf_ispezionati_importati, /*Buf importati CD*/                          \
coalesce( t_buf_ispezionati_altro.sum, 0 )as n_buf_ispezionati_altro, /*Buf da altro CD*/                              \
coalesce( t_bovini_ispezionati_cd.sum, 0 )as bovini_ispezionati_cd, /*Bovini da macello CD*/                \
coalesce( t_suini_ispezionati_cd.sum, 0 )as suini_ispezionati_cd, /*Suini da macello CD*/                  \
coalesce( t_piccoli_ispezionati_cd.sum, 0 )as piccoli_ispezionati_cd, /*Piccoli Ruminanti da macello CD*/    \
coalesce( t_equidi_ispezionati_cd.sum, 0 )as equidi_ispezionati_cd, /*Equidi da macello CD*/                \
coalesce( t_volatili_ispezionati_cd.sum, 0 )as volatili_ispezionati_cd, /*Volatili da macello CD*/            \
coalesce( t_altre_ispezionati_cd.sum, 0 )as altre_ispezionati_cd, /*Altre da macello CD*/                  \
coalesce( t_buf_ispezionati_cd.sum, 0 )as buf_ispezionati_cd, /*Buf da macello CD*/                    \
coalesce( t_bovini_trasp_isp.sum, 0 )as bovini_trasp_isp, /*Bovini da macello ISP*/                      \
coalesce( t_bovini_arrivo_isp.sum, 0 )as bovini_arrivo_isp, /*Bovini da esportazione CD*/                \
coalesce( t_bovini_mercato_isp.sum, 0 )as bovini_mercato_isp, /*Bovini importati CD*/                      \
coalesce( t_bovini_partenza_isp.sum, 0 )as bovini_partenza_isp, /*Bovini da altro CD*/                      \
coalesce( t_bovini_sosta_isp.sum, 0 )as bovini_sosta_isp, /*Bovini importati CD*/                        \
coalesce( t_bovini_trasf_isp.sum, 0 )as bovini_trasf_isp, /*Bovini da altro CD*/                        \
coalesce( t_suini_trasp_isp.sum, 0 )as suini_trasp_isp, /*Suini da macello CD*/                        \
coalesce( t_suini_arrivo_isp.sum, 0 )as suini_arrivo_isp, /*Suini da esportazione CD*/                  \
coalesce( t_suini_mercato_isp.sum, 0 )as suini_mercato_isp, /*Suini importati CD*/                        \
coalesce( t_suini_partenza_isp.sum, 0 )as suini_partenza_isp, /*Suini da altro CD*/                        \
coalesce( t_suini_sosta_isp.sum, 0 )as suini_sosta_isp, /*Suini importati CD*/                          \
coalesce( t_suini_traf_isp.sum, 0 )as suini_traf_isp, /*Suini da altro CD*/                            \
coalesce( t_piccoli_trasp_isp.sum, 0 )as piccoli_trasp_isp, /*Piccoli Ruminanti da macello CD*/          \
coalesce( t_piccoli_arrivo_isp.sum, 0 )as piccoli_arrivo_isp, /*Piccoli Ruminanti da esportazione CD*/    \
coalesce( t_piccoli_mercato_isp.sum, 0 )as piccoli_mercato_isp, /*Piccoli Ruminanti importati CD*/          \
coalesce( t_piccoli_partenza_isp.sum, 0 )as piccoli_partenza_isp, /*Piccoli Ruminanti da altro CD*/          \
coalesce( t_piccoli_sosta_isp.sum, 0 )as piccoli_sosta_isp, /*Piccoli Ruminanti importati CD*/            \
coalesce( t_piccoli_trasf_isp.sum, 0 )as piccoli_trasf_isp, /*Piccoli Ruminanti da altro CD*/            \
coalesce( t_equidi_trasp_isp.sum, 0 )as equidi_trasp_isp, /*Equidi da macello CD*/                      \
coalesce( t_equidi_arrivo_isp.sum, 0 )as equidi_arrivo_isp, /*Equidi da esportazione CD*/                \
coalesce( t_equidi_mercato_isp.sum, 0 )as equidi_mercato_isp, /*Equidi importati CD*/                      \
coalesce( t_equidi_partenza_isp.sum, 0 )as equidi_partenza_isp, /*Equidi da altro CD*/                      \
coalesce( t_equidi_sosta_isp.sum, 0 )as equidi_sosta_isp, /*Equidi importati CD*/                        \
coalesce( t_equidi_trasf_isp.sum, 0 )as equidi_trasf_isp, /*Equidi da altro CD*/                        \
coalesce( t_volatili_trasp_isp.sum, 0 )as volatili_trasp_isp, /*Volatili da macello CD*/                  \
coalesce( t_volatili_arrivo_isp.sum, 0 )as volatili_arrivo_isp, /*Volatili da esportazione CD*/            \
coalesce( t_volatili_mercato_isp.sum, 0 ) as volatili_mercato_isp, /*Volatili importati CD*/                \
coalesce( t_volatili_partenza_isp.sum, 0 ) as volatili_partenza_isp, /*Volatili da altro CD*/                \
coalesce( t_volatili_sosta_isp.sum, 0 ) as volatili_sosta_isp, /*Volatili importati CD*/                  \
coalesce( t_volatili_trasf_isp.sum, 0 ) as volatili_trasf_isp, /*Volatili da altro CD*/                    \
coalesce( t_altre_trasp_isp.sum, 0 ) as altre_trasp_isp, /*Altre da macello CD*/                        \
coalesce( t_altre_arrivo_isp.sum, 0 ) as altre_arrivo_isp, /*Altre da esportazione CD*/                  \
coalesce( t_altre_mercato_isp.sum, 0 ) as altre_mercato_isp, /*Altre importati CD*/                      \
coalesce( t_altre_partenza_isp.sum, 0 ) as altre_partenza_isp, /*Altre da altro CD*/                      \
coalesce( t_altre_sosta_isp.sum, 0 ) as altre_sosta_isp, /*Altre importati CD*/                        \
coalesce( t_altre_trasf_isp.sum, 0 ) as altre_trasf_isp, /*Altre da altro CD*/                          \
coalesce( t_buf_trasp_isp.sum, 0 ) as buf_trasp_isp,    \
coalesce( t_buf_arrivo_isp.sum, 0 ) as buf_arrivo_isp,\
coalesce( t_buf_mercato_isp.sum, 0 ) as buf_mercato_isp,    \
coalesce( t_buf_partenza_isp.sum, 0 ) as buf_partenza_isp,    \
coalesce( t_buf_sosta_isp.sum, 0 ) as buf_sosta_isp ,      \
coalesce( t_buf_trasf_isp.sum, 0 ) as buf_trasf_isp ,  \
coalesce( t_trasp_mezzi.sum, 0 ) as trasp_mezzi, /*Bovini da macello CD*/          \
coalesce( t_arrivo_mezzi.sum, 0 ) as arrivo_mezzi, /*Bovini da esportazione CD*/    \
coalesce( t_mercato_mezzi.sum, 0 ) as mercato_mezzi, /*Bovini importati CD*/          \
coalesce( t_partenza_mezzi.sum, 0 ) as partenza_mezzi, /*Bovini da altro CD*/          \
coalesce( t_sosta_mezzi.sum, 0 ) as sosta_mezzi, /*Suini da macello CD*/            \
coalesce( t_trasf_mezzi.sum, 0 ) as trasf_mezzi, /*Suini da esportazione CD*/      \
coalesce( t_cd_mezzi_isp.sum, 0 ) as cd_mezzi_isp, /*Buf da altro CD*/                    \
coalesce( t_bovini_viol_cd.sum, 0 ) as bovini_viol_cd, /*Bovini da macello CD*/            \
coalesce( t_suini_viol_cd.sum, 0 ) as suini_viol_cd, /*Suini da macello CD*/              \
coalesce( t_piccoli_viol_cd.sum, 0 )as  piccoli_viol_cd, /*Piccoli Ruminanti da macello CD*/\
coalesce( t_equidi_viol_cd.sum, 0 )as  equidi_viol_cd, /*Equidi da macello CD*/            \
coalesce( t_volatili_viol_cd.sum, 0 )as  volatili_viol_cd, /*Volatili da macello CD*/        \
coalesce( t_altre_viol_cd.sum, 0 )as  altre_viol_cd, /*Altre da macello CD*/              \
coalesce( t_buf_viol_cd.sum, 0 )as  buf_viol_cd, /*Buf da macello CD*/                  \
coalesce( t_bovini_trasp_viol.sum, 0 )as bovini_trasp_viol, /*Bovini da macello ISP*/                \
coalesce( t_bovini_arrivo_viol.sum, 0 )as bovini_arrivo_viol, /*Bovini da esportazione CD*/            \
coalesce( t_bovini_mercato_viol.sum, 0 )as bovini_mercato_viol, /*Bovini importati CD*/                \
coalesce( t_bovini_partenza_viol.sum, 0 )as bovini_partenza_viol, /*Bovini da altro CD*/                \
coalesce( t_bovini_sosta_viol.sum, 0 )as bovini_sosta_viol, /*Bovini importati CD*/                  \
coalesce( t_bovini_trasf_viol.sum, 0 )as bovini_trasf_viol, /*Bovini da altro CD*/                    \
coalesce( t_suini_trasp_viol.sum, 0 )as suini_trasp_viol, /*Suini da macello CD*/                    \
coalesce( t_suini_arrivo_viol.sum, 0 )as suini_arrivo_viol, /*Suini da esportazione CD*/              \
coalesce( t_suini_mercato_viol.sum, 0 )as suini_mercato_viol, /*Suini importati CD*/                  \
coalesce( t_suini_partenza_viol.sum, 0 )as suini_partenza_viol, /*Suini da altro CD*/                  \
coalesce( t_suini_sosta_viol.sum, 0 )as suini_sosta_viol, /*Suini importati CD*/                    \
coalesce( t_suini_traf_viol.sum, 0 )as suini_traf_viol, /*Suini da altro CD*/                      \
coalesce( t_piccoli_trasp_viol.sum, 0 )as piccoli_trasp_viol, /*Piccoli Ruminanti da macello CD*/      \
coalesce( t_piccoli_arrivo_viol.sum, 0 )as piccoli_arrivo_viol, /*Piccoli Ruminanti da esportazione CD*/\
coalesce( t_piccoli_mercato_viol.sum, 0 )as piccoli_mercato_viol, /*Piccoli Ruminanti importati CD*/    \
coalesce( t_piccoli_partenza_viol.sum, 0 )as piccoli_partenza_viol, /*Piccoli Ruminanti da altro CD*/    \
coalesce( t_piccoli_sosta_viol.sum, 0 )as piccoli_sosta_viol, /*Piccoli Ruminanti importati CD*/      \
coalesce( t_piccoli_trasf_viol.sum, 0 )as piccoli_trasf_viol, /*Piccoli Ruminanti da altro CD*/        \
coalesce( t_equidi_trasp_viol.sum, 0 )as  equidi_trasp_viol, /*Equidi da macello CD*/                  \
coalesce( t_equidi_arrivo_viol.sum, 0 )as equidi_arrivo_viol, /*Equidi da esportazione CD*/            \
coalesce( t_equidi_mercato_viol.sum, 0 )as equidi_mercato_viol, /*Equidi importati CD*/                \
coalesce( t_equidi_partenza_viol.sum, 0 )as equidi_partenza_viol, /*Equidi da altro CD*/                \
coalesce( t_equidi_sosta_viol.sum, 0 )as equidi_sosta_viol, /*Equidi importati CD*/                  \
coalesce( t_equidi_trasf_viol.sum, 0 )as equidi_trasf_viol, /*Equidi da altro CD*/                    \
coalesce( t_volatili_trasp_viol.sum, 0 )as volatili_trasp_viol, /*Volatili da macello CD*/              \
coalesce( t_volatili_arrivo_viol.sum, 0 )as volatili_arrivo_viol, /*Volatili da esportazione CD*/        \
coalesce( t_volatili_mercato_viol.sum, 0 )as volatili_mercato_viol, /*Volatili importati CD*/            \
coalesce( t_volatili_partenza_viol.sum, 0 )as volatili_partenza_viol, /*Volatili da altro CD*/            \
coalesce( t_volatili_sosta_viol.sum, 0 )as volatili_sosta_viol, /*Volatili importati CD*/              \
coalesce( t_volatili_trasf_viol.sum, 0 )as volatili_trasf_viol, /*Volatili da altro CD*/                \
coalesce( t_altre_trasp_viol.sum, 0 )as altre_trasp_viol, /*Altre da macello CD*/                    \
coalesce( t_altre_arrivo_viol.sum, 0 )as altre_arrivo_viol, /*Altre da esportazione CD*/              \
coalesce( t_altre_mercato_viol.sum, 0 )as altre_mercato_viol, /*Altre importati CD*/                  \
coalesce( t_altre_partenza_viol.sum, 0 )as altre_partenza_viol, /*Altre da altro CD*/                  \
coalesce( t_altre_sosta_viol.sum, 0 )as altre_sosta_viol, /*Altre importati CD*/                    \
coalesce( t_altre_trasf_viol.sum, 0 )as altre_trasf_viol, /*Altre da altro CD*/                      \
coalesce( t_buf_trasp_viol.sum, 0 )as buf_trasp_viol, /*Buf da macello CD*/                      \
coalesce( t_buf_arrivo_viol.sum, 0 )as buf_arrivo_viol, /*Buf da esportazione CD*/                \
coalesce( t_buf_mercato_viol.sum, 0 )as buf_mercato_viol, /*Buf importati CD*/                      \
coalesce( t_buf_partenza_viol.sum, 0 )as buf_partenza_viol, /*Buf da altro CD*/                      \
coalesce( t_buf_sosta_viol.sum, 0 )as buf_sosta_viol, /*Buf importati CD*/                        \
coalesce( t_buf_trasf_viol.sum, 0 )as buf_trasf_viol, /*Buf da altro CD*/                        \
coalesce( t_trasp_mezzi_viol.sum, 0 )as trasp_mezzi_viol, /*Bovini da macello CD*/        \
coalesce( t_arrivo_mezzi_viol.sum, 0 )as arrivo_mezzi_viol, /*Bovini da esportazione CD*/  \
coalesce( t_mercato_mezzi_viol.sum, 0 )as mercato_mezzi_viol, /*Bovini importati CD*/      \
coalesce( t_partenza_mezzi_viol.sum, 0 )as partenza_mezzi_viol, /*Bovini da altro CD*/      \
coalesce( t_sosta_mezzi_viol.sum, 0 )as sosta_mezzi_viol, /*Suini da macello CD*/        \
coalesce( t_trasf_mezzi_viol.sum, 0 )as trasf_mezzi_viol, /*Suini da esportazione CD*/    \
coalesce( t_cd_mezzi_viol.sum, 0 )as cd_mezzi_viol /*Buf da altro CD*/\
FROM ( SELECT ? as anno )appoggio \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=1  \
                group by date_part('year',assigned_date))t_bovini_ispezionati_macello        \
                ON appoggio.anno = t_bovini_ispezionati_macello.anno                      \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno                  \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=1  \
                group by date_part('year',assigned_date)) t_bovini_ispezionati_esportazione \
                ON appoggio.anno = t_bovini_ispezionati_esportazione.anno                      \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=1 \
                group by date_part('year',assigned_date)) t_bovini_ispezionati_importati \
                ON appoggio.anno = t_bovini_ispezionati_importati.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=1  \
                group by date_part('year',assigned_date)) t_bovini_ispezionati_altro \
                ON appoggio.anno = t_bovini_ispezionati_altro.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=2  \
                group by date_part('year',assigned_date)) t_suini_ispezionati_macello \
                ON appoggio.anno = t_suini_ispezionati_macello.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=2   \
                group by date_part('year',assigned_date)) t_suini_ispezionati_esportazione           \
                ON appoggio.anno = t_suini_ispezionati_esportazione.anno                               \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno                           \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=2   \
                group by date_part('year',assigned_date)) t_suini_ispezionati_importati               \
                ON appoggio.anno = t_suini_ispezionati_importati.anno                                 \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=2  \
                group by date_part('year',assigned_date)) t_suini_ispezionati_altro  \
                ON appoggio.anno = t_suini_ispezionati_altro.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=3  \
                group by date_part('year',assigned_date)) t_piccoli_ispezionati_macello  \
                ON appoggio.anno = t_piccoli_ispezionati_macello.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=3  \
                group by date_part('year',assigned_date)) t_piccoli_ispezionati_esportazione  \
                ON appoggio.anno = t_piccoli_ispezionati_esportazione.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=3  \
                group by date_part('year',assigned_date)) t_piccoli_ispezionati_importati  \
                ON appoggio.anno = t_piccoli_ispezionati_importati.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=3  \
                group by date_part('year',assigned_date)) t_piccoli_ispezionati_altro  \
                ON appoggio.anno = t_piccoli_ispezionati_altro.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=4  \
                group by date_part('year',assigned_date)) t_equidi_ispezionati_macello  \
                ON appoggio.anno = t_equidi_ispezionati_macello.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=4  \
                group by date_part('year',assigned_date)) t_equidi_ispezionati_esportazione  \
                ON appoggio.anno = t_equidi_ispezionati_esportazione.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=4  \
                group by date_part('year',assigned_date)) t_equidi_ispezionati_importati  \
                ON appoggio.anno = t_equidi_ispezionati_importati.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=4  \
                group by date_part('year',assigned_date)) t_equidi_ispezionati_altro  \
                ON appoggio.anno = t_equidi_ispezionati_altro.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=5  \
                group by date_part('year',assigned_date)) t_volatili_ispezionati_macello  \
                ON appoggio.anno = t_volatili_ispezionati_macello.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=5  \
                group by date_part('year',assigned_date)) t_volatili_ispezionati_esportazione  \
                ON appoggio.anno = t_volatili_ispezionati_esportazione.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=5  \
                group by date_part('year',assigned_date)) t_volatili_ispezionati_importati  \
                ON appoggio.anno = t_volatili_ispezionati_importati.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=5  \
                group by date_part('year',assigned_date)) t_volatili_ispezionati_altro  \
                ON appoggio.anno = t_volatili_ispezionati_altro.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=6  \
                group by date_part('year',assigned_date)) t_altre_ispezionati_macello  \
                ON appoggio.anno = t_altre_ispezionati_macello.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=6  \
                group by date_part('year',assigned_date)) t_altre_ispezionati_esportazione  \
                ON appoggio.anno = t_altre_ispezionati_esportazione.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=6  \
                group by date_part('year',assigned_date)) t_altre_ispezionati_importati  \
                ON appoggio.anno = t_altre_ispezionati_importati.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=6  \
                group by date_part('year',assigned_date)) t_altre_ispezionati_altro  \
                ON appoggio.anno = t_altre_ispezionati_altro.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=10  \
                group by date_part('year',assigned_date)) t_buf_ispezionati_macello  \
                ON appoggio.anno = t_buf_ispezionati_macello.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=10  \
                group by date_part('year',assigned_date))t_buf_ispezionati_esportazione  \
                ON appoggio.anno = t_buf_ispezionati_esportazione.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=10                 \
                group by date_part('year',assigned_date))t_buf_ispezionati_importati  \
                ON appoggio.anno = t_buf_ispezionati_importati.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=10  \
                group by date_part('year',assigned_date))t_buf_ispezionati_altro \
                ON appoggio.anno = t_buf_ispezionati_altro.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date)) t_bovini_ispezionati_cd \
                ON appoggio.anno = t_bovini_ispezionati_cd.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date)) t_suini_ispezionati_cd                 \
                ON appoggio.anno = t_suini_ispezionati_cd.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno                                 \
                from ticket where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date)) t_piccoli_ispezionati_cd                         \
                ON appoggio.anno = t_piccoli_ispezionati_cd.anno                                             \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date)) t_equidi_ispezionati_cd \
                ON appoggio.anno = t_equidi_ispezionati_cd.anno                                                       \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date)) t_volatili_ispezionati_cd \
                ON appoggio.anno = t_volatili_ispezionati_cd.anno           \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date)) t_altre_ispezionati_cd \
                ON appoggio.anno = t_altre_ispezionati_cd.anno           \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date))t_buf_ispezionati_cd                     \
			    ON appoggio.anno = t_buf_ispezionati_cd.anno  \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket join tipocontrolloufficialeimprese t1 on(ticket.ticketid = t1.idcontrollo and t1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_bovini_trasp_isp  \
                ON appoggio.anno = t_bovini_trasp_isp.anno                       \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno  \
                from ticket join tipocontrolloufficialeimprese t2 on(ticket.ticketid = t2.idcontrollo and t2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_bovini_arrivo_isp \
                ON appoggio.anno = t_bovini_arrivo_isp.anno   \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t3 on(ticket.ticketid = t3.idcontrollo and t3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_bovini_mercato_isp \
                ON appoggio.anno = t_bovini_mercato_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t4 on(ticket.ticketid = t4.idcontrollo and t4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_bovini_partenza_isp                       \
                ON appoggio.anno = t_bovini_partenza_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t5 on(ticket.ticketid = t5.idcontrollo and t5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_bovini_sosta_isp                           \
                ON appoggio.anno = t_bovini_sosta_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t6 on(ticket.ticketid = t6.idcontrollo and t6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_bovini_trasf_isp                           \
                ON appoggio.anno = t_bovini_trasf_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c1 on(ticket.ticketid = c1.idcontrollo and c1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_suini_trasp_isp                           \
                ON appoggio.anno = t_suini_trasp_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c2 on(ticket.ticketid = c2.idcontrollo and c2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_suini_arrivo_isp                           \
                ON appoggio.anno = t_suini_arrivo_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c3 on(ticket.ticketid = c3.idcontrollo and c3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_suini_mercato_isp                         \
                ON appoggio.anno = t_suini_mercato_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c4 on(ticket.ticketid = c4.idcontrollo and c4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_suini_partenza_isp                         \
                ON appoggio.anno = t_suini_partenza_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c5 on(ticket.ticketid = c5.idcontrollo and c5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_suini_sosta_isp                           \
                ON appoggio.anno = t_suini_sosta_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c6 on(ticket.ticketid = c6.idcontrollo and c6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_suini_traf_isp                             \
                ON appoggio.anno = t_suini_traf_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d1 on(ticket.ticketid = d1.idcontrollo and d1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_piccoli_trasp_isp                         \
                ON appoggio.anno = t_piccoli_trasp_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d2 on(ticket.ticketid = d2.idcontrollo and d2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_piccoli_arrivo_isp                         \
                ON appoggio.anno = t_piccoli_arrivo_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d3 on(ticket.ticketid = d3.idcontrollo and d3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_piccoli_mercato_isp                       \
                ON appoggio.anno = t_piccoli_mercato_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d4 on(ticket.ticketid = d4.idcontrollo and d4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_piccoli_partenza_isp                       \
                ON appoggio.anno = t_piccoli_partenza_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d5 on(ticket.ticketid = d5.idcontrollo and d5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_piccoli_sosta_isp                         \
                ON appoggio.anno = t_piccoli_sosta_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d6 on(ticket.ticketid = d6.idcontrollo and d6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_piccoli_trasf_isp                         \
                ON appoggio.anno = t_piccoli_trasf_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s1 on(ticket.ticketid = s1.idcontrollo and s1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_equidi_trasp_isp                           \
                ON appoggio.anno = t_equidi_trasp_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s2 on(ticket.ticketid = s2.idcontrollo and s2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_equidi_arrivo_isp                         \
                ON appoggio.anno = t_equidi_arrivo_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s3 on(ticket.ticketid = s3.idcontrollo and s3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_equidi_mercato_isp                         \
                ON appoggio.anno = t_equidi_mercato_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s4 on(ticket.ticketid = s4.idcontrollo and s4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_equidi_partenza_isp                       \
                ON appoggio.anno = t_equidi_partenza_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s5 on(ticket.ticketid = s5.idcontrollo and s5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_equidi_sosta_isp                           \
                ON appoggio.anno = t_equidi_sosta_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s6 on(ticket.ticketid = s6.idcontrollo and s6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_equidi_trasf_isp                           \
                ON appoggio.anno = t_equidi_trasf_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese x1 on(ticket.ticketid = x1.idcontrollo and x1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_volatili_trasp_isp                         \
                ON appoggio.anno = t_volatili_trasp_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese x2 on(ticket.ticketid = x2.idcontrollo and x2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_volatili_arrivo_isp                       \
                ON appoggio.anno = t_volatili_arrivo_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x3 on(ticket.ticketid = x3.idcontrollo and x3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_volatili_mercato_isp                       \
                ON appoggio.anno = t_volatili_mercato_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x4 on(ticket.ticketid = x4.idcontrollo and x4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_volatili_partenza_isp                     \
                ON appoggio.anno = t_volatili_partenza_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x5 on(ticket.ticketid = x5.idcontrollo and x5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_volatili_sosta_isp                         \
                ON appoggio.anno = t_volatili_sosta_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x6 on(ticket.ticketid = x6.idcontrollo and x6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_volatili_trasf_isp                         \
                ON appoggio.anno = t_volatili_trasf_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r1 on(ticket.ticketid = r1.idcontrollo and r1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_altre_trasp_isp                           \
                ON appoggio.anno = t_altre_trasp_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r2 on(ticket.ticketid = r2.idcontrollo and r2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_altre_arrivo_isp                           \
                ON appoggio.anno = t_altre_arrivo_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r3 on(ticket.ticketid = r3.idcontrollo and r3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_altre_mercato_isp                         \
                ON appoggio.anno = t_altre_mercato_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                        from ticket join tipocontrolloufficialeimprese r4 on(ticket.ticketid = r4.idcontrollo and r4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                        group by date_part('year',assigned_date))t_altre_partenza_isp                         \
                        ON appoggio.anno = t_altre_partenza_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r5 on(ticket.ticketid = r5.idcontrollo and r5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_altre_sosta_isp                           \
                ON appoggio.anno = t_altre_sosta_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r6 on(ticket.ticketid = r6.idcontrollo and r6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_altre_trasf_isp                           \
                ON appoggio.anno = t_altre_trasf_isp.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y1 on(ticket.ticketid = y1.idcontrollo and y1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_buf_trasp_isp \
                ON appoggio.anno = t_buf_trasp_isp .anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y2 on(ticket.ticketid = y2.idcontrollo and y2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_buf_arrivo_isp   \
                ON appoggio.anno = t_buf_arrivo_isp.anno             \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y3 on(ticket.ticketid = y3.idcontrollo and y3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_buf_mercato_isp \
                ON appoggio.anno = t_buf_mercato_isp.anno                       \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y4 on(ticket.ticketid = y4.idcontrollo and y4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_buf_partenza_isp \
                ON appoggio.anno = t_buf_partenza_isp.anno                     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y5 on(ticket.ticketid = y5.idcontrollo and y5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_buf_sosta_isp \
                ON appoggio.anno = t_buf_sosta_isp.anno                         \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y6 on(ticket.ticketid = y6.idcontrollo and y6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_buf_trasf_isp \
                ON appoggio.anno = t_buf_trasf_isp.anno                                 \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p1 on(ticket.ticketid = p1.idcontrollo and p1.tipoispezione = 1) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_trasp_mezzi \
    ON appoggio.anno = t_trasp_mezzi.anno           \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p2 on(ticket.ticketid = p2.idcontrollo and p2.tipoispezione = 2) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_arrivo_mezzi \
                ON appoggio.anno = t_arrivo_mezzi.anno \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p3 on(ticket.ticketid = p3.idcontrollo and p3.tipoispezione = 3) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date))t_mercato_mezzi \
                ON appoggio.anno = t_mercato_mezzi.anno       \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p4 on(ticket.ticketid = p4.idcontrollo and p4.tipoispezione = 4) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_partenza_mezzi \
                ON appoggio.anno = t_partenza_mezzi.anno   \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p5 on(ticket.ticketid = p5.idcontrollo and p5.tipoispezione = 5) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_sosta_mezzi \
                ON appoggio.anno = t_sosta_mezzi.anno       \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p6 on(ticket.ticketid = p6.idcontrollo and p6.tipoispezione = 6) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_trasf_mezzi \
                ON appoggio.anno = t_trasf_mezzi.anno \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date)) t_cd_mezzi_isp \
                ON appoggio.anno = t_cd_mezzi_isp.anno                 \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_bovini_viol_cd \
                ON appoggio.anno = t_bovini_viol_cd.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_suini_viol_cd \
                ON appoggio.anno = t_suini_viol_cd.anno                     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE   \
                group by date_part('year',assigned_date)) t_piccoli_viol_cd \
                ON appoggio.anno = t_piccoli_viol_cd.anno               \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_equidi_viol_cd \
                ON appoggio.anno = t_equidi_viol_cd.anno                 \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE   \
                group by date_part('year',assigned_date))t_volatili_viol_cd \
                ON appoggio.anno = t_volatili_viol_cd.anno   \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE   \
                group by date_part('year',assigned_date)) t_altre_viol_cd \
                ON appoggio.anno = t_altre_viol_cd.anno               \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_buf_viol_cd \
                ON appoggio.anno = t_buf_viol_cd.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t1 on(ticket.ticketid = t1.idcontrollo and t1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_bovini_trasp_viol \
                ON appoggio.anno = t_bovini_trasp_viol.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t2 on(ticket.ticketid = t2.idcontrollo and t2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_bovini_arrivo_viol \
                ON appoggio.anno = t_bovini_arrivo_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t3 on(ticket.ticketid = t3.idcontrollo and t3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_bovini_mercato_viol \
                ON appoggio.anno = t_bovini_mercato_viol.anno                       \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t4 on(ticket.ticketid = t4.idcontrollo and t4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_bovini_partenza_viol \
                ON appoggio.anno = t_bovini_partenza_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t5 on(ticket.ticketid = t5.idcontrollo and t5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_bovini_sosta_viol \
                ON appoggio.anno = t_bovini_sosta_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t6 on(ticket.ticketid = t6.idcontrollo and t6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_bovini_trasf_viol \
                ON appoggio.anno = t_bovini_trasf_viol.anno   \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c1 on(ticket.ticketid = c1.idcontrollo and c1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_suini_trasp_viol \
                ON appoggio.anno = t_suini_trasp_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c2 on(ticket.ticketid = c2.idcontrollo and c2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_suini_arrivo_viol \
                ON appoggio.anno = t_suini_arrivo_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c3 on(ticket.ticketid = c3.idcontrollo and c3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_suini_mercato_viol \
                ON appoggio.anno = t_suini_mercato_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c4 on(ticket.ticketid = c4.idcontrollo and c4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_suini_partenza_viol \
                ON appoggio.anno = t_suini_partenza_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c5 on(ticket.ticketid = c5.idcontrollo and c5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_suini_sosta_viol \
                ON appoggio.anno = t_suini_sosta_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c6 on(ticket.ticketid = c6.idcontrollo and c6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_suini_traf_viol \
                ON appoggio.anno = t_suini_traf_viol.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d1 on(ticket.ticketid = d1.idcontrollo and d1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_piccoli_trasp_viol \
                ON appoggio.anno = t_piccoli_trasp_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d2 on(ticket.ticketid = d2.idcontrollo and d2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_piccoli_arrivo_viol \
                ON appoggio.anno = t_piccoli_arrivo_viol.anno                     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d3 on(ticket.ticketid = d3.idcontrollo and d3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_piccoli_mercato_viol \
                ON appoggio.anno = t_piccoli_mercato_viol.anno                         \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d4 on(ticket.ticketid = d4.idcontrollo and d4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_piccoli_partenza_viol \
                ON appoggio.anno = t_piccoli_partenza_viol.anno                         \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d5 on(ticket.ticketid = d5.idcontrollo and d5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_piccoli_sosta_viol \
                ON appoggio.anno = t_piccoli_sosta_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d6 on(ticket.ticketid = d6.idcontrollo and d6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_piccoli_trasf_viol \
                ON appoggio.anno = t_piccoli_trasf_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s1 on(ticket.ticketid = s1.idcontrollo and s1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_equidi_trasp_viol \
                ON appoggio.anno = t_equidi_trasp_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s2 on(ticket.ticketid = s2.idcontrollo and s2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_equidi_arrivo_viol \
                ON appoggio.anno = t_equidi_arrivo_viol.anno   \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s3 on(ticket.ticketid = s3.idcontrollo and s3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_equidi_mercato_viol \
                ON appoggio.anno = t_equidi_mercato_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s4 on(ticket.ticketid = s4.idcontrollo and s4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_equidi_partenza_viol \
                ON appoggio.anno = t_equidi_partenza_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s5 on(ticket.ticketid = s5.idcontrollo and s5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_equidi_sosta_viol \
                ON appoggio.anno = t_equidi_sosta_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s6 on(ticket.ticketid = s6.idcontrollo and s6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_equidi_trasf_viol \
                ON appoggio.anno = t_equidi_trasf_viol.anno \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x1 on(ticket.ticketid = x1.idcontrollo and x1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_volatili_trasp_viol \
                ON appoggio.anno = t_volatili_trasp_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x2 on(ticket.ticketid = x2.idcontrollo and x2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_volatili_arrivo_viol \
                ON appoggio.anno = t_volatili_arrivo_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x3 on(ticket.ticketid = x3.idcontrollo and x3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_volatili_mercato_viol \
                ON appoggio.anno = t_volatili_mercato_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x4 on(ticket.ticketid = x4.idcontrollo and x4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_volatili_partenza_viol \
                ON appoggio.anno = t_volatili_partenza_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x5 on(ticket.ticketid = x5.idcontrollo and x5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_volatili_sosta_viol \
                ON appoggio.anno = t_volatili_sosta_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x6 on(ticket.ticketid = x6.idcontrollo and x6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_volatili_trasf_viol \
                ON appoggio.anno = t_volatili_trasf_viol.anno   \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r1 on(ticket.ticketid = r1.idcontrollo and r1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_altre_trasp_viol \
                ON appoggio.anno = t_altre_trasp_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r2 on(ticket.ticketid = r2.idcontrollo and r2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_altre_arrivo_viol \
                ON appoggio.anno = t_altre_arrivo_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r3 on(ticket.ticketid = r3.idcontrollo and r3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_altre_mercato_viol \
                ON appoggio.anno = t_altre_mercato_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r4 on(ticket.ticketid = r4.idcontrollo and r4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_altre_partenza_viol \
                ON appoggio.anno = t_altre_partenza_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r5 on(ticket.ticketid = r5.idcontrollo and r5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_altre_sosta_viol \
                ON appoggio.anno = t_altre_sosta_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r6 on(ticket.ticketid = r6.idcontrollo and r6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_altre_trasf_viol \
                ON appoggio.anno = t_altre_trasf_viol.anno   \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y1 on(ticket.ticketid = y1.idcontrollo and y1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_buf_trasp_viol \
                ON appoggio.anno = t_buf_trasp_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y2 on(ticket.ticketid = y2.idcontrollo and y2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_buf_arrivo_viol \
                ON appoggio.anno = t_buf_arrivo_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y3 on(ticket.ticketid = y3.idcontrollo and y3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_buf_mercato_viol \
                ON appoggio.anno = t_buf_mercato_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y4 on(ticket.ticketid = y4.idcontrollo and y4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_buf_partenza_viol \
                ON appoggio.anno = t_buf_partenza_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y5 on(ticket.ticketid = y5.idcontrollo and y5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_buf_sosta_viol \
                ON appoggio.anno = t_buf_sosta_viol.anno     \
LEFT JOIN (select SUM(animali), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y6 on(ticket.ticketid = y6.idcontrollo and y6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_buf_trasf_viol \
                ON appoggio.anno = t_buf_trasf_viol.anno                           \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p1 on(ticket.ticketid = p1.idcontrollo and p1.tipoispezione = 1) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))   t_trasp_mezzi_viol \
                ON appoggio.anno = t_trasp_mezzi_viol.anno \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p2 on(ticket.ticketid = p2.idcontrollo and p2.tipoispezione = 2) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date)) t_arrivo_mezzi_viol \
                ON appoggio.anno = t_arrivo_mezzi_viol.anno \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p3 on(ticket.ticketid = p3.idcontrollo and p3.tipoispezione = 3) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_mercato_mezzi_viol \
                ON appoggio.anno = t_mercato_mezzi_viol.anno \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p4 on(ticket.ticketid = p4.idcontrollo and p4.tipoispezione = 4) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))  t_partenza_mezzi_viol \
                ON appoggio.anno = t_partenza_mezzi_viol.anno \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p5 on(ticket.ticketid = p5.idcontrollo and p5.tipoispezione = 5) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_sosta_mezzi_viol \
                ON appoggio.anno = t_sosta_mezzi_viol.anno \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p6 on(ticket.ticketid = p6.idcontrollo and p6.tipoispezione = 6) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date))t_trasf_mezzi_viol \
                ON appoggio.anno = t_trasf_mezzi_viol.anno  \
LEFT JOIN (select SUM(mezziispezionati), date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE                                                                                                                                                                                                                                                                                                                                                                                                                         \
                group by date_part('year',assigned_date))t_cd_mezzi_viol  \
                ON appoggio.anno = t_cd_mezzi_viol.anno;
                
GET_RENDICONTAZIONE_ASL = select                       \
appoggio.anno,asl.description as nomeAsl, \
coalesce( t_bovini_ispezionati_macello.sum, 0 )as n_bovini_ispezionati_macello, \
coalesce( t_bovini_ispezionati_esportazione.sum, 0 )as n_bovini_ispezionati_esportazione, \
coalesce( t_bovini_ispezionati_importati.sum, 0 )as n_bovini_ispezionati_importati, /*Bovini importati CD*/                     \
coalesce( t_bovini_ispezionati_altro.sum, 0 )as n_bovini_ispezionati_altro, /*Bovini da altro CD*/                           \
coalesce( t_suini_ispezionati_macello.sum, 0 )as n_suini_ispezionati_macello, /*Suini da macello CD*/                         \
coalesce( t_suini_ispezionati_esportazione.sum, 0 )as n_suini_ispezionati_esportazione, /*Suini da esportazione CD*/               \
coalesce( t_suini_ispezionati_importati.sum, 0 )as n_suini_ispezionati_importati, /*Suini importati CD*/                       \
coalesce( t_suini_ispezionati_altro.sum, 0 )as n_suini_ispezionati_altro, /*Suini da altro CD*/                             \
coalesce( t_piccoli_ispezionati_macello.sum, 0 )as n_piccoli_ispezionati_macello, /*Piccoli Ruminanti da macello CD*/           \
coalesce( t_piccoli_ispezionati_esportazione.sum, 0 )as n_piccoli_ispezionati_esportazione, /*Piccoli Ruminanti da esportazione CD*/ \
coalesce( t_piccoli_ispezionati_importati.sum, 0 )as n_piccoli_ispezionati_importati, /*Piccoli Ruminanti importati CD*/         \
coalesce( t_piccoli_ispezionati_altro.sum, 0 )as n_piccoli_ispezionati_altro, /*Piccoli Ruminanti da altro CD*/               \
coalesce( t_equidi_ispezionati_macello.sum, 0 )as n_equidi_ispezionati_macello, /*Equidi da macello CD*/                       \
coalesce( t_equidi_ispezionati_esportazione.sum, 0 )as n_equidi_ispezionati_esportazione, /*Equidi da esportazione CD*/             \
coalesce( t_equidi_ispezionati_importati.sum, 0 )as n_equidi_ispezionati_importati, /*Equidi importati CD*/                     \
coalesce( t_equidi_ispezionati_altro.sum, 0 )as n_equidi_ispezionati_altro, /*Equidi da altro CD*/                           \
coalesce( t_volatili_ispezionati_macello.sum, 0 )as n_volatili_ispezionati_macello, /*Volatili da macello CD*/                   \
coalesce( t_volatili_ispezionati_esportazione.sum, 0 )as n_volatili_ispezionati_esportazione, /*Volatili da esportazione CD*/         \
coalesce( t_volatili_ispezionati_importati.sum, 0 )as n_volatili_ispezionati_importati, /*Volatili importati CD*/                 \
coalesce( t_volatili_ispezionati_altro.sum, 0 )as n_volatili_ispezionati_altro, /*Volatili da altro CD*/                       \
coalesce( t_altre_ispezionati_macello.sum, 0 )as n_altre_ispezionati_macello, /*Altre da macello CD*/                         \
coalesce( t_altre_ispezionati_esportazione.sum, 0 )as n_altre_ispezionati_esportazione, /*Altre da esportazione CD*/               \
coalesce( t_altre_ispezionati_importati.sum, 0 )as n_altre_ispezionati_importati, /*Altre importati CD*/                       \
coalesce( t_altre_ispezionati_altro.sum, 0 )as n_altre_ispezionati_altro, /*Altre da altro CD*/                             \
coalesce( t_buf_ispezionati_macello.sum, 0 )as n_buf_ispezionati_macello, /*Buf da macello CD*/                           \
coalesce( t_buf_ispezionati_esportazione.sum, 0 )as n_buf_ispezionati_esportazione, /*Buf da esportazione CD*/                 \
coalesce( t_buf_ispezionati_importati.sum, 0 )as n_buf_ispezionati_importati, /*Buf importati CD*/                           \
coalesce( t_buf_ispezionati_altro.sum, 0 )as n_buf_ispezionati_altro, /*Buf da altro CD*/                               \
coalesce( t_bovini_ispezionati_cd.sum, 0 )as bovini_ispezionati_cd, /*Bovini da macello CD*/                 \
coalesce( t_suini_ispezionati_cd.sum, 0 )as suini_ispezionati_cd, /*Suini da macello CD*/                   \
coalesce( t_piccoli_ispezionati_cd.sum, 0 )as piccoli_ispezionati_cd, /*Piccoli Ruminanti da macello CD*/     \
coalesce( t_equidi_ispezionati_cd.sum, 0 )as equidi_ispezionati_cd, /*Equidi da macello CD*/                 \
coalesce( t_volatili_ispezionati_cd.sum, 0 )as volatili_ispezionati_cd, /*Volatili da macello CD*/             \
coalesce( t_altre_ispezionati_cd.sum, 0 )as altre_ispezionati_cd, /*Altre da macello CD*/                   \
coalesce( t_buf_ispezionati_cd.sum, 0 )as buf_ispezionati_cd, /*Buf da macello CD*/                     \
coalesce( t_bovini_trasp_isp.sum, 0 )as bovini_trasp_isp, /*Bovini da macello ISP*/                       \
coalesce( t_bovini_arrivo_isp.sum, 0 )as bovini_arrivo_isp, /*Bovini da esportazione CD*/                 \
coalesce( t_bovini_mercato_isp.sum, 0 )as bovini_mercato_isp, /*Bovini importati CD*/                       \
coalesce( t_bovini_partenza_isp.sum, 0 )as bovini_partenza_isp, /*Bovini da altro CD*/                       \
coalesce( t_bovini_sosta_isp.sum, 0 )as bovini_sosta_isp, /*Bovini importati CD*/                         \
coalesce( t_bovini_trasf_isp.sum, 0 )as bovini_trasf_isp, /*Bovini da altro CD*/                         \
coalesce( t_suini_trasp_isp.sum, 0 )as suini_trasp_isp, /*Suini da macello CD*/                         \
coalesce( t_suini_arrivo_isp.sum, 0 )as suini_arrivo_isp, /*Suini da esportazione CD*/                   \
coalesce( t_suini_mercato_isp.sum, 0 )as suini_mercato_isp, /*Suini importati CD*/                         \
coalesce( t_suini_partenza_isp.sum, 0 )as suini_partenza_isp, /*Suini da altro CD*/                         \
coalesce( t_suini_sosta_isp.sum, 0 )as suini_sosta_isp, /*Suini importati CD*/                           \
coalesce( t_suini_traf_isp.sum, 0 )as suini_traf_isp, /*Suini da altro CD*/                             \
coalesce( t_piccoli_trasp_isp.sum, 0 )as piccoli_trasp_isp, /*Piccoli Ruminanti da macello CD*/           \
coalesce( t_piccoli_arrivo_isp.sum, 0 )as piccoli_arrivo_isp, /*Piccoli Ruminanti da esportazione CD*/     \
coalesce( t_piccoli_mercato_isp.sum, 0 )as piccoli_mercato_isp, /*Piccoli Ruminanti importati CD*/           \
coalesce( t_piccoli_partenza_isp.sum, 0 )as piccoli_partenza_isp, /*Piccoli Ruminanti da altro CD*/           \
coalesce( t_piccoli_sosta_isp.sum, 0 )as piccoli_sosta_isp, /*Piccoli Ruminanti importati CD*/             \
coalesce( t_piccoli_trasf_isp.sum, 0 )as piccoli_trasf_isp, /*Piccoli Ruminanti da altro CD*/             \
coalesce( t_equidi_trasp_isp.sum, 0 )as equidi_trasp_isp, /*Equidi da macello CD*/                       \
coalesce( t_equidi_arrivo_isp.sum, 0 )as equidi_arrivo_isp, /*Equidi da esportazione CD*/                 \
coalesce( t_equidi_mercato_isp.sum, 0 )as equidi_mercato_isp, /*Equidi importati CD*/                       \
coalesce( t_equidi_partenza_isp.sum, 0 )as equidi_partenza_isp, /*Equidi da altro CD*/                       \
coalesce( t_equidi_sosta_isp.sum, 0 )as equidi_sosta_isp, /*Equidi importati CD*/                         \
coalesce( t_equidi_trasf_isp.sum, 0 )as equidi_trasf_isp, /*Equidi da altro CD*/                         \
coalesce( t_volatili_trasp_isp.sum, 0 )as volatili_trasp_isp, /*Volatili da macello CD*/                   \
coalesce( t_volatili_arrivo_isp.sum, 0 )as volatili_arrivo_isp, /*Volatili da esportazione CD*/             \
coalesce( t_volatili_mercato_isp.sum, 0 ) as volatili_mercato_isp, /*Volatili importati CD*/                 \
coalesce( t_volatili_partenza_isp.sum, 0 ) as volatili_partenza_isp, /*Volatili da altro CD*/                 \
coalesce( t_volatili_sosta_isp.sum, 0 ) as volatili_sosta_isp, /*Volatili importati CD*/                   \
coalesce( t_volatili_trasf_isp.sum, 0 ) as volatili_trasf_isp, /*Volatili da altro CD*/                     \
coalesce( t_altre_trasp_isp.sum, 0 ) as altre_trasp_isp, /*Altre da macello CD*/                         \
coalesce( t_altre_arrivo_isp.sum, 0 ) as altre_arrivo_isp, /*Altre da esportazione CD*/                   \
coalesce( t_altre_mercato_isp.sum, 0 ) as altre_mercato_isp, /*Altre importati CD*/                       \
coalesce( t_altre_partenza_isp.sum, 0 ) as altre_partenza_isp, /*Altre da altro CD*/                       \
coalesce( t_altre_sosta_isp.sum, 0 ) as altre_sosta_isp, /*Altre importati CD*/                         \
coalesce( t_altre_trasf_isp.sum, 0 ) as altre_trasf_isp, /*Altre da altro CD*/                           \
coalesce( t_buf_trasp_isp.sum, 0 ) as buf_trasp_isp,     \
coalesce( t_buf_arrivo_isp.sum, 0 ) as buf_arrivo_isp, \
coalesce( t_buf_mercato_isp.sum, 0 ) as buf_mercato_isp,     \
coalesce( t_buf_partenza_isp.sum, 0 ) as buf_partenza_isp,     \
coalesce( t_buf_sosta_isp.sum, 0 ) as buf_sosta_isp ,       \
coalesce( t_buf_trasf_isp.sum, 0 ) as buf_trasf_isp ,   \
coalesce( t_trasp_mezzi.sum, 0 ) as trasp_mezzi, /*Bovini da macello CD*/           \
coalesce( t_arrivo_mezzi.sum, 0 ) as arrivo_mezzi, /*Bovini da esportazione CD*/     \
coalesce( t_mercato_mezzi.sum, 0 ) as mercato_mezzi, /*Bovini importati CD*/           \
coalesce( t_partenza_mezzi.sum, 0 ) as partenza_mezzi, /*Bovini da altro CD*/           \
coalesce( t_sosta_mezzi.sum, 0 ) as sosta_mezzi, /*Suini da macello CD*/             \
coalesce( t_trasf_mezzi.sum, 0 ) as trasf_mezzi, /*Suini da esportazione CD*/       \
coalesce( t_cd_mezzi_isp.sum, 0 ) as cd_mezzi_isp, /*Buf da altro CD*/                     \
coalesce( t_bovini_viol_cd.sum, 0 ) as bovini_viol_cd, /*Bovini da macello CD*/             \
coalesce( t_suini_viol_cd.sum, 0 ) as suini_viol_cd, /*Suini da macello CD*/               \
coalesce( t_piccoli_viol_cd.sum, 0 )as  piccoli_viol_cd, /*Piccoli Ruminanti da macello CD*/ \
coalesce( t_equidi_viol_cd.sum, 0 )as  equidi_viol_cd, /*Equidi da macello CD*/             \
coalesce( t_volatili_viol_cd.sum, 0 )as  volatili_viol_cd, /*Volatili da macello CD*/         \
coalesce( t_altre_viol_cd.sum, 0 )as  altre_viol_cd, /*Altre da macello CD*/               \
coalesce( t_buf_viol_cd.sum, 0 )as  buf_viol_cd, /*Buf da macello CD*/                   \
coalesce( t_bovini_trasp_viol.sum, 0 )as bovini_trasp_viol, /*Bovini da macello ISP*/                 \
coalesce( t_bovini_arrivo_viol.sum, 0 )as bovini_arrivo_viol, /*Bovini da esportazione CD*/             \
coalesce( t_bovini_mercato_viol.sum, 0 )as bovini_mercato_viol, /*Bovini importati CD*/                 \
coalesce( t_bovini_partenza_viol.sum, 0 )as bovini_partenza_viol, /*Bovini da altro CD*/                 \
coalesce( t_bovini_sosta_viol.sum, 0 )as bovini_sosta_viol, /*Bovini importati CD*/                   \
coalesce( t_bovini_trasf_viol.sum, 0 )as bovini_trasf_viol, /*Bovini da altro CD*/                     \
coalesce( t_suini_trasp_viol.sum, 0 )as suini_trasp_viol, /*Suini da macello CD*/                     \
coalesce( t_suini_arrivo_viol.sum, 0 )as suini_arrivo_viol, /*Suini da esportazione CD*/               \
coalesce( t_suini_mercato_viol.sum, 0 )as suini_mercato_viol, /*Suini importati CD*/                   \
coalesce( t_suini_partenza_viol.sum, 0 )as suini_partenza_viol, /*Suini da altro CD*/                   \
coalesce( t_suini_sosta_viol.sum, 0 )as suini_sosta_viol, /*Suini importati CD*/                     \
coalesce( t_suini_traf_viol.sum, 0 )as suini_traf_viol, /*Suini da altro CD*/                       \
coalesce( t_piccoli_trasp_viol.sum, 0 )as piccoli_trasp_viol, /*Piccoli Ruminanti da macello CD*/       \
coalesce( t_piccoli_arrivo_viol.sum, 0 )as piccoli_arrivo_viol, /*Piccoli Ruminanti da esportazione CD*/ \
coalesce( t_piccoli_mercato_viol.sum, 0 )as piccoli_mercato_viol, /*Piccoli Ruminanti importati CD*/     \
coalesce( t_piccoli_partenza_viol.sum, 0 )as piccoli_partenza_viol, /*Piccoli Ruminanti da altro CD*/     \
coalesce( t_piccoli_sosta_viol.sum, 0 )as piccoli_sosta_viol, /*Piccoli Ruminanti importati CD*/       \
coalesce( t_piccoli_trasf_viol.sum, 0 )as piccoli_trasf_viol, /*Piccoli Ruminanti da altro CD*/         \
coalesce( t_equidi_trasp_viol.sum, 0 )as  equidi_trasp_viol, /*Equidi da macello CD*/                   \
coalesce( t_equidi_arrivo_viol.sum, 0 )as equidi_arrivo_viol, /*Equidi da esportazione CD*/             \
coalesce( t_equidi_mercato_viol.sum, 0 )as equidi_mercato_viol, /*Equidi importati CD*/                 \
coalesce( t_equidi_partenza_viol.sum, 0 )as equidi_partenza_viol, /*Equidi da altro CD*/                 \
coalesce( t_equidi_sosta_viol.sum, 0 )as equidi_sosta_viol, /*Equidi importati CD*/                   \
coalesce( t_equidi_trasf_viol.sum, 0 )as equidi_trasf_viol, /*Equidi da altro CD*/                     \
coalesce( t_volatili_trasp_viol.sum, 0 )as volatili_trasp_viol, /*Volatili da macello CD*/               \
coalesce( t_volatili_arrivo_viol.sum, 0 )as volatili_arrivo_viol, /*Volatili da esportazione CD*/         \
coalesce( t_volatili_mercato_viol.sum, 0 )as volatili_mercato_viol, /*Volatili importati CD*/             \
coalesce( t_volatili_partenza_viol.sum, 0 )as volatili_partenza_viol, /*Volatili da altro CD*/             \
coalesce( t_volatili_sosta_viol.sum, 0 )as volatili_sosta_viol, /*Volatili importati CD*/               \
coalesce( t_volatili_trasf_viol.sum, 0 )as volatili_trasf_viol, /*Volatili da altro CD*/                 \
coalesce( t_altre_trasp_viol.sum, 0 )as altre_trasp_viol, /*Altre da macello CD*/                     \
coalesce( t_altre_arrivo_viol.sum, 0 )as altre_arrivo_viol, /*Altre da esportazione CD*/               \
coalesce( t_altre_mercato_viol.sum, 0 )as altre_mercato_viol, /*Altre importati CD*/                   \
coalesce( t_altre_partenza_viol.sum, 0 )as altre_partenza_viol, /*Altre da altro CD*/                   \
coalesce( t_altre_sosta_viol.sum, 0 )as altre_sosta_viol, /*Altre importati CD*/                     \
coalesce( t_altre_trasf_viol.sum, 0 )as altre_trasf_viol, /*Altre da altro CD*/                       \
coalesce( t_buf_trasp_viol.sum, 0 )as buf_trasp_viol, /*Buf da macello CD*/                       \
coalesce( t_buf_arrivo_viol.sum, 0 )as buf_arrivo_viol, /*Buf da esportazione CD*/                 \
coalesce( t_buf_mercato_viol.sum, 0 )as buf_mercato_viol, /*Buf importati CD*/                       \
coalesce( t_buf_partenza_viol.sum, 0 )as buf_partenza_viol, /*Buf da altro CD*/                       \
coalesce( t_buf_sosta_viol.sum, 0 )as buf_sosta_viol, /*Buf importati CD*/                         \
coalesce( t_buf_trasf_viol.sum, 0 )as buf_trasf_viol, /*Buf da altro CD*/                         \
coalesce( t_trasp_mezzi_viol.sum, 0 )as trasp_mezzi_viol, /*Bovini da macello CD*/         \
coalesce( t_arrivo_mezzi_viol.sum, 0 )as arrivo_mezzi_viol, /*Bovini da esportazione CD*/   \
coalesce( t_mercato_mezzi_viol.sum, 0 )as mercato_mezzi_viol, /*Bovini importati CD*/       \
coalesce( t_partenza_mezzi_viol.sum, 0 )as partenza_mezzi_viol, /*Bovini da altro CD*/       \
coalesce( t_sosta_mezzi_viol.sum, 0 )as sosta_mezzi_viol, /*Suini da macello CD*/         \
coalesce( t_trasf_mezzi_viol.sum, 0 )as trasf_mezzi_viol, /*Suini da esportazione CD*/     \
coalesce( t_cd_mezzi_viol.sum, 0 )as cd_mezzi_viol /*Buf da altro CD*/                 \
FROM  ( SELECT ? as anno , ? as idAsl )appoggio  -- l'anno che stai cercando \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno                  \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=1   \
                group by date_part('year',assigned_date),idAsl)t_bovini_ispezionati_macello         \
                ON appoggio.anno = t_bovini_ispezionati_macello.anno and appoggio.idAsl = t_bovini_ispezionati_macello.idAsl                       \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno                   \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=1   \
                group by date_part('year',assigned_date),idAsl) t_bovini_ispezionati_esportazione \
                ON appoggio.anno = t_bovini_ispezionati_esportazione.anno  and appoggio.idAsl = t_bovini_ispezionati_esportazione.idAsl               \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=1 \
                group by date_part('year',assigned_date),idAsl) t_bovini_ispezionati_importati \
                ON appoggio.anno = t_bovini_ispezionati_importati.anno and appoggio.idAsl = t_bovini_ispezionati_importati.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=1 \
                group by date_part('year',assigned_date),idAsl) t_bovini_ispezionati_altro \
                ON appoggio.anno = t_bovini_ispezionati_altro.anno and appoggio.idAsl = t_bovini_ispezionati_altro.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=2 \
                group by date_part('year',assigned_date),idAsl) t_suini_ispezionati_macello \
                ON appoggio.anno = t_suini_ispezionati_macello.anno and appoggio.idAsl = t_suini_ispezionati_macello.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=2   \
                group by date_part('year',assigned_date),idAsl) t_suini_ispezionati_esportazione           \
                ON appoggio.anno = t_suini_ispezionati_esportazione.anno and  appoggio.idAsl = t_suini_ispezionati_esportazione.idAsl                              \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno                           \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=2   \
                group by date_part('year',assigned_date),idAsl) t_suini_ispezionati_importati               \
                ON appoggio.anno = t_suini_ispezionati_importati.anno   and appoggio.idAsl = t_suini_ispezionati_importati.idAsl                                 \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=2 \
                group by date_part('year',assigned_date),idAsl) t_suini_ispezionati_altro \
                ON appoggio.anno = t_suini_ispezionati_altro.anno and appoggio.idAsl = t_suini_ispezionati_altro.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=3 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_ispezionati_macello \
                ON appoggio.anno = t_piccoli_ispezionati_macello.anno and appoggio.idAsl = t_piccoli_ispezionati_macello.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=3 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_ispezionati_esportazione \
                ON appoggio.anno = t_piccoli_ispezionati_esportazione.anno and appoggio.idAsl = t_piccoli_ispezionati_esportazione.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=3 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_ispezionati_importati \
                ON appoggio.anno = t_piccoli_ispezionati_importati.anno and appoggio.idAsl = t_piccoli_ispezionati_importati.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=3 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_ispezionati_altro \
                ON appoggio.anno = t_piccoli_ispezionati_altro.anno and appoggio.idAsl = t_piccoli_ispezionati_altro.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno                 \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_ispezionati_macello \
                ON appoggio.anno = t_equidi_ispezionati_macello.anno and appoggio.idAsl = t_equidi_ispezionati_macello.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_ispezionati_esportazione \
                ON appoggio.anno = t_equidi_ispezionati_esportazione.anno and appoggio.idAsl = t_equidi_ispezionati_esportazione.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_ispezionati_importati \
                ON appoggio.anno = t_equidi_ispezionati_importati.anno and  appoggio.idAsl = t_equidi_ispezionati_importati.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_ispezionati_altro \
                ON appoggio.anno = t_equidi_ispezionati_altro.anno and  appoggio.idAsl = t_equidi_ispezionati_altro.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=5 \
                group by date_part('year',assigned_date),idAsl) t_volatili_ispezionati_macello \
                ON appoggio.anno = t_volatili_ispezionati_macello.anno and appoggio.idAsl = t_volatili_ispezionati_macello.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=5 \
                group by date_part('year',assigned_date),idAsl) t_volatili_ispezionati_esportazione \
                ON appoggio.anno = t_volatili_ispezionati_esportazione.anno and appoggio.idAsl = t_volatili_ispezionati_esportazione.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=5 \
                group by date_part('year',assigned_date),idAsl) t_volatili_ispezionati_importati \
                ON appoggio.anno = t_volatili_ispezionati_importati.anno and appoggio.idAsl = t_volatili_ispezionati_importati.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=5 \
                group by date_part('year',assigned_date),idAsl) t_volatili_ispezionati_altro \
                ON appoggio.anno = t_volatili_ispezionati_altro.anno and appoggio.idAsl = t_volatili_ispezionati_altro.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=6 \
                group by date_part('year',assigned_date),idAsl) t_altre_ispezionati_macello \
                ON appoggio.anno = t_altre_ispezionati_macello.anno and appoggio.idAsl = t_altre_ispezionati_macello.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=6 \
                group by date_part('year',assigned_date),idAsl) t_altre_ispezionati_esportazione \
                ON appoggio.anno = t_altre_ispezionati_esportazione.anno and appoggio.idAsl = t_altre_ispezionati_esportazione.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=6 \
                group by date_part('year',assigned_date),idAsl) t_altre_ispezionati_importati \
                ON appoggio.anno = t_altre_ispezionati_importati.anno and appoggio.idAsl = t_altre_ispezionati_importati.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=6 \
                group by date_part('year',assigned_date),idAsl) t_altre_ispezionati_altro \
                ON appoggio.anno = t_altre_ispezionati_altro.anno and appoggio.idAsl = t_altre_ispezionati_altro.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 1 and animalitrasportati=10 \
                group by date_part('year',assigned_date),idAsl) t_buf_ispezionati_macello \
                ON appoggio.anno = t_buf_ispezionati_macello.anno and appoggio.idAsl = t_buf_ispezionati_macello.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 2 and animalitrasportati=10 \
                group by date_part('year',assigned_date),idAsl)t_buf_ispezionati_esportazione \
                ON appoggio.anno = t_buf_ispezionati_esportazione.anno and appoggio.idAsl = t_buf_ispezionati_esportazione.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 3 and animalitrasportati=10                 \
                group by date_part('year',assigned_date),idAsl)t_buf_ispezionati_importati \
                ON appoggio.anno = t_buf_ispezionati_importati.anno and appoggio.idAsl = t_buf_ispezionati_importati.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and specietrasportata = 4 and animalitrasportati=10 \
                group by date_part('year',assigned_date),idAsl)t_buf_ispezionati_altro \
                ON appoggio.anno = t_buf_ispezionati_altro.anno and appoggio.idAsl = t_buf_ispezionati_altro.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date),idAsl) t_bovini_ispezionati_cd \
                ON appoggio.anno = t_bovini_ispezionati_cd.anno and appoggio.idAsl = t_bovini_ispezionati_cd.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date),idAsl) t_suini_ispezionati_cd                 \
                ON appoggio.anno = t_suini_ispezionati_cd.anno     and appoggio.idAsl = t_suini_ispezionati_cd.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno                                 \
                from ticket where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_ispezionati_cd                         \
                ON appoggio.anno = t_piccoli_ispezionati_cd.anno   and appoggio.idAsl = t_piccoli_ispezionati_cd.idAsl                                            \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date),idAsl) t_equidi_ispezionati_cd \
                ON appoggio.anno = t_equidi_ispezionati_cd.anno and appoggio.idAsl = t_equidi_ispezionati_cd.idAsl                                                        \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date),idAsl) t_volatili_ispezionati_cd \
                ON appoggio.anno = t_volatili_ispezionati_cd.anno    and appoggio.idAsl = t_volatili_ispezionati_cd.idAsl      \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date),idAsl) t_altre_ispezionati_cd \
                ON appoggio.anno = t_altre_ispezionati_cd.anno   and appoggio.idAsl = t_altre_ispezionati_cd.idAsl       \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 3 \
                group by date_part('year',assigned_date),idAsl)t_buf_ispezionati_cd                     \
    ON appoggio.anno = t_buf_ispezionati_cd.anno and appoggio.idAsl = t_buf_ispezionati_cd.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t1 on(ticket.ticketid = t1.idcontrollo and t1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_bovini_trasp_isp \
                ON appoggio.anno = t_bovini_trasp_isp.anno and appoggio.idAsl = t_bovini_trasp_isp.idAsl                     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t2 on(ticket.ticketid = t2.idcontrollo and t2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_bovini_arrivo_isp \
                ON appoggio.anno = t_bovini_arrivo_isp.anno and  appoggio.idAsl = t_bovini_arrivo_isp.idAsl   \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t3 on(ticket.ticketid = t3.idcontrollo and t3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_bovini_mercato_isp \
                ON appoggio.anno = t_bovini_mercato_isp.anno and  appoggio.idAsl = t_bovini_mercato_isp.idAsl \
 \
 \
 \
 \
                 \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t4 on(ticket.ticketid = t4.idcontrollo and t4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_bovini_partenza_isp                       \
                ON appoggio.anno = t_bovini_partenza_isp.anno and appoggio.idAsl = t_bovini_partenza_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t5 on(ticket.ticketid = t5.idcontrollo and t5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_bovini_sosta_isp                           \
                ON appoggio.anno = t_bovini_sosta_isp.anno and appoggio.idAsl = t_bovini_sosta_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese t6 on(ticket.ticketid = t6.idcontrollo and t6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_bovini_trasf_isp                           \
                ON appoggio.anno = t_bovini_trasf_isp.anno and appoggio.idAsl = t_bovini_trasf_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c1 on(ticket.ticketid = c1.idcontrollo and c1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_suini_trasp_isp                           \
                ON appoggio.anno = t_suini_trasp_isp.anno and appoggio.idAsl = t_suini_trasp_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c2 on(ticket.ticketid = c2.idcontrollo and c2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_suini_arrivo_isp                           \
                ON appoggio.anno = t_suini_arrivo_isp.anno and appoggio.idAsl = t_suini_arrivo_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c3 on(ticket.ticketid = c3.idcontrollo and c3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_suini_mercato_isp                         \
                ON appoggio.anno = t_suini_mercato_isp.anno and appoggio.idAsl = t_suini_mercato_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c4 on(ticket.ticketid = c4.idcontrollo and c4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_suini_partenza_isp                         \
                ON appoggio.anno = t_suini_partenza_isp.anno and  appoggio.idAsl = t_suini_partenza_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c5 on(ticket.ticketid = c5.idcontrollo and c5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_suini_sosta_isp                           \
                ON appoggio.anno = t_suini_sosta_isp.anno and appoggio.idAsl = t_suini_sosta_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese c6 on(ticket.ticketid = c6.idcontrollo and c6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_suini_traf_isp                             \
                ON appoggio.anno = t_suini_traf_isp.anno and appoggio.idAsl = t_suini_traf_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d1 on(ticket.ticketid = d1.idcontrollo and d1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_trasp_isp                         \
                ON appoggio.anno = t_piccoli_trasp_isp.anno and appoggio.idAsl = t_piccoli_trasp_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d2 on(ticket.ticketid = d2.idcontrollo and d2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_arrivo_isp                         \
                ON appoggio.anno = t_piccoli_arrivo_isp.anno and appoggio.idAsl = t_piccoli_arrivo_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d3 on(ticket.ticketid = d3.idcontrollo and d3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_mercato_isp                       \
                ON appoggio.anno = t_piccoli_mercato_isp.anno and appoggio.idAsl = t_piccoli_mercato_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d4 on(ticket.ticketid = d4.idcontrollo and d4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_partenza_isp                       \
                ON appoggio.anno = t_piccoli_partenza_isp.anno and appoggio.idAsl = t_piccoli_partenza_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d5 on(ticket.ticketid = d5.idcontrollo and d5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_sosta_isp                         \
                ON appoggio.anno = t_piccoli_sosta_isp.anno and appoggio.idAsl = t_piccoli_sosta_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese d6 on(ticket.ticketid = d6.idcontrollo and d6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_piccoli_trasf_isp                         \
                ON appoggio.anno = t_piccoli_trasf_isp.anno and appoggio.idAsl = t_piccoli_trasf_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s1 on(ticket.ticketid = s1.idcontrollo and s1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_trasp_isp                           \
                ON appoggio.anno = t_equidi_trasp_isp.anno and appoggio.idAsl = t_equidi_trasp_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s2 on(ticket.ticketid = s2.idcontrollo and s2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_arrivo_isp                         \
                ON appoggio.anno = t_equidi_arrivo_isp.anno and appoggio.idAsl = t_equidi_arrivo_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s3 on(ticket.ticketid = s3.idcontrollo and s3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_mercato_isp                         \
                ON appoggio.anno = t_equidi_mercato_isp.anno and appoggio.idAsl = t_equidi_mercato_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s4 on(ticket.ticketid = s4.idcontrollo and s4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_partenza_isp                       \
                ON appoggio.anno = t_equidi_partenza_isp.anno and appoggio.idAsl = t_equidi_partenza_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s5 on(ticket.ticketid = s5.idcontrollo and s5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_sosta_isp                           \
                ON appoggio.anno = t_equidi_sosta_isp.anno and appoggio.idAsl= t_equidi_sosta_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese s6 on(ticket.ticketid = s6.idcontrollo and s6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_equidi_trasf_isp                           \
                ON appoggio.anno = t_equidi_trasf_isp.anno and appoggio.idAsl = t_equidi_trasf_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese x1 on(ticket.ticketid = x1.idcontrollo and x1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_volatili_trasp_isp                         \
                ON appoggio.anno = t_volatili_trasp_isp.anno and appoggio.idAsl = t_volatili_trasp_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese x2 on(ticket.ticketid = x2.idcontrollo and x2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_volatili_arrivo_isp                       \
                ON appoggio.anno = t_volatili_arrivo_isp.anno and appoggio.idAsl = t_volatili_arrivo_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x3 on(ticket.ticketid = x3.idcontrollo and x3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_volatili_mercato_isp                       \
                ON appoggio.anno = t_volatili_mercato_isp.anno and appoggio.idAsl = t_volatili_mercato_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x4 on(ticket.ticketid = x4.idcontrollo and x4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_volatili_partenza_isp                     \
                ON appoggio.anno = t_volatili_partenza_isp.anno and appoggio.idAsl= t_volatili_partenza_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x5 on(ticket.ticketid = x5.idcontrollo and x5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_volatili_sosta_isp                         \
                ON appoggio.anno = t_volatili_sosta_isp.anno and appoggio.idAsl = t_volatili_sosta_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x6 on(ticket.ticketid = x6.idcontrollo and x6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_volatili_trasf_isp                         \
                ON appoggio.anno = t_volatili_trasf_isp.anno and appoggio.idAsl = t_volatili_trasf_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r1 on(ticket.ticketid = r1.idcontrollo and r1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_altre_trasp_isp                           \
                ON appoggio.anno = t_altre_trasp_isp.anno and appoggio.idAsl = t_altre_trasp_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r2 on(ticket.ticketid = r2.idcontrollo and r2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_altre_arrivo_isp                           \
                ON appoggio.anno = t_altre_arrivo_isp.anno and appoggio.idAsl = t_altre_arrivo_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r3 on(ticket.ticketid = r3.idcontrollo and r3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_altre_mercato_isp                         \
                ON appoggio.anno = t_altre_mercato_isp.anno and appoggio.idAsl = t_altre_mercato_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                        from ticket join tipocontrolloufficialeimprese r4 on(ticket.ticketid = r4.idcontrollo and r4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                        group by date_part('year',assigned_date),idAsl)t_altre_partenza_isp                         \
                        ON appoggio.anno = t_altre_partenza_isp.anno and appoggio.idAsl = t_altre_partenza_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r5 on(ticket.ticketid = r5.idcontrollo and r5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_altre_sosta_isp                           \
                ON appoggio.anno = t_altre_sosta_isp.anno and appoggio.idAsl = t_altre_sosta_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r6 on(ticket.ticketid = r6.idcontrollo and r6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_altre_trasf_isp                           \
                ON appoggio.anno = t_altre_trasf_isp.anno and appoggio.idAsl = t_altre_trasf_isp.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y1 on(ticket.ticketid = y1.idcontrollo and y1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_buf_trasp_isp \
                ON appoggio.anno = t_buf_trasp_isp .anno and appoggio.idAsl = t_buf_trasp_isp .idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y2 on(ticket.ticketid = y2.idcontrollo and y2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_buf_arrivo_isp   \
                ON appoggio.anno = t_buf_arrivo_isp.anno  and appoggio.idAsl = t_buf_arrivo_isp.idAsl           \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y3 on(ticket.ticketid = y3.idcontrollo and y3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_buf_mercato_isp \
                ON appoggio.anno = t_buf_mercato_isp.anno and  appoggio.idAsl = t_buf_mercato_isp.idAsl                      \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y4 on(ticket.ticketid = y4.idcontrollo and y4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_buf_partenza_isp \
                ON appoggio.anno = t_buf_partenza_isp.anno    and appoggio.idAsl = t_buf_partenza_isp.idAsl                  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y5 on(ticket.ticketid = y5.idcontrollo and y5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_buf_sosta_isp \
                ON appoggio.anno = t_buf_sosta_isp.anno and appoggio.idAsl = t_buf_sosta_isp.idAsl                         \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y6 on(ticket.ticketid = y6.idcontrollo and y6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_buf_trasf_isp \
                ON appoggio.anno = t_buf_trasf_isp.anno  and appoggio.idAsl = t_buf_trasf_isp.idAsl                               \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno \
                from ticket join tipocontrolloufficialeimprese p1 on(ticket.ticketid = p1.idcontrollo and p1.tipoispezione = 1) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_trasp_mezzi \
    ON appoggio.anno = t_trasp_mezzi.anno   and appoggio.idAsl = t_trasp_mezzi.idAsl        \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p2 on(ticket.ticketid = p2.idcontrollo and p2.tipoispezione = 2) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_arrivo_mezzi \
                ON appoggio.anno = t_arrivo_mezzi.anno and appoggio.idAsl = t_arrivo_mezzi.idAsl \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p3 on(ticket.ticketid = p3.idcontrollo and p3.tipoispezione = 3) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl)t_mercato_mezzi \
                ON appoggio.anno = t_mercato_mezzi.anno  and  appoggio.idAsl = t_mercato_mezzi.idAsl      \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p4 on(ticket.ticketid = p4.idcontrollo and p4.tipoispezione = 4) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_partenza_mezzi \
                ON appoggio.anno = t_partenza_mezzi.anno  and appoggio.idAsl = t_partenza_mezzi.idAsl  \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p5 on(ticket.ticketid = p5.idcontrollo and p5.tipoispezione = 5) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_sosta_mezzi \
                ON appoggio.anno = t_sosta_mezzi.anno and appoggio.idAsl = t_sosta_mezzi.idAsl      \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p6 on(ticket.ticketid = p6.idcontrollo and p6.tipoispezione = 6) where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_trasf_mezzi \
                ON appoggio.anno = t_trasf_mezzi.anno and appoggio.idAsl = t_trasf_mezzi.idAsl \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and provvedimenti_prescrittivi = 4 \
                group by date_part('year',assigned_date),idAsl) t_cd_mezzi_isp \
                ON appoggio.anno = t_cd_mezzi_isp.anno  and appoggio.idAsl = t_cd_mezzi_isp.idAsl                \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE         \
                group by date_part('year',assigned_date),idAsl) t_bovini_viol_cd \
                ON appoggio.anno = t_bovini_viol_cd.anno and appoggio.idAsl = t_bovini_viol_cd.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_suini_viol_cd \
                ON appoggio.anno = t_suini_viol_cd.anno   and appoggio.idAsl = t_suini_viol_cd.idAsl                     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE   \
                group by date_part('year',assigned_date),idAsl) t_piccoli_viol_cd \
                ON appoggio.anno = t_piccoli_viol_cd.anno and appoggio.idAsl = t_piccoli_viol_cd.idAsl              \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_equidi_viol_cd \
                ON appoggio.anno = t_equidi_viol_cd.anno   and appoggio.idAsl = t_equidi_viol_cd.idAsl               \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE   \
                group by date_part('year',assigned_date),idAsl)t_volatili_viol_cd \
                ON appoggio.anno = t_volatili_viol_cd.anno  and appoggio.idAsl = t_volatili_viol_cd.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE   \
                group by date_part('year',assigned_date),idAsl) t_altre_viol_cd \
                ON appoggio.anno = t_altre_viol_cd.anno  and appoggio.idAsl = t_altre_viol_cd.idAsl              \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 3  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_buf_viol_cd \
                ON appoggio.anno = t_buf_viol_cd.anno and appoggio.idAsl = t_buf_viol_cd.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t1 on(ticket.ticketid = t1.idcontrollo and t1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_bovini_trasp_viol \
                ON appoggio.anno = t_bovini_trasp_viol.anno and appoggio.idAsl = t_bovini_trasp_viol.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t2 on(ticket.ticketid = t2.idcontrollo and t2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_bovini_arrivo_viol \
                ON appoggio.anno = t_bovini_arrivo_viol.anno   and appoggio.idAsl = t_bovini_arrivo_viol.idAsl   \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t3 on(ticket.ticketid = t3.idcontrollo and t3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_bovini_mercato_viol \
                ON appoggio.anno = t_bovini_mercato_viol.anno  and appoggio.idAsl = t_bovini_mercato_viol.idAsl                      \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t4 on(ticket.ticketid = t4.idcontrollo and t4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_bovini_partenza_viol \
                ON appoggio.anno = t_bovini_partenza_viol.anno   and appoggio.idAsl = t_bovini_partenza_viol.idAsl   \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t5 on(ticket.ticketid = t5.idcontrollo and t5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_bovini_sosta_viol \
                ON appoggio.anno = t_bovini_sosta_viol.anno    and appoggio.idAsl = t_bovini_sosta_viol.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese t6 on(ticket.ticketid = t6.idcontrollo and t6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=1 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_bovini_trasf_viol \
                ON appoggio.anno = t_bovini_trasf_viol.anno  and appoggio.idAsl = t_bovini_trasf_viol.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c1 on(ticket.ticketid = c1.idcontrollo and c1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_suini_trasp_viol \
                ON appoggio.anno = t_suini_trasp_viol.anno and appoggio.idAsl = t_suini_trasp_viol.idAsl     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c2 on(ticket.ticketid = c2.idcontrollo and c2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_suini_arrivo_viol \
                ON appoggio.anno = t_suini_arrivo_viol.anno and appoggio.idAsl = t_suini_arrivo_viol.idAsl     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c3 on(ticket.ticketid = c3.idcontrollo and c3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_suini_mercato_viol \
                ON appoggio.anno = t_suini_mercato_viol.anno and appoggio.idAsl = t_suini_mercato_viol.idAsl     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c4 on(ticket.ticketid = c4.idcontrollo and c4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_suini_partenza_viol \
                ON appoggio.anno = t_suini_partenza_viol.anno   and appoggio.idAsl = t_suini_partenza_viol.idAsl   \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c5 on(ticket.ticketid = c5.idcontrollo and c5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_suini_sosta_viol \
                ON appoggio.anno = t_suini_sosta_viol.anno  and appoggio.idAsl = t_suini_sosta_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese c6 on(ticket.ticketid = c6.idcontrollo and c6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=2 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_suini_traf_viol \
                ON appoggio.anno = t_suini_traf_viol.anno and appoggio.idAsl = t_suini_traf_viol.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d1 on(ticket.ticketid = d1.idcontrollo and d1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_piccoli_trasp_viol \
                ON appoggio.anno = t_piccoli_trasp_viol.anno and appoggio.idAsl = t_piccoli_trasp_viol.idAsl     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d2 on(ticket.ticketid = d2.idcontrollo and d2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_piccoli_arrivo_viol \
                ON appoggio.anno = t_piccoli_arrivo_viol.anno and appoggio.idAsl = t_piccoli_arrivo_viol.idAsl                     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d3 on(ticket.ticketid = d3.idcontrollo and d3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_piccoli_mercato_viol \
                ON appoggio.anno = t_piccoli_mercato_viol.anno  and appoggio.idAsl = t_piccoli_mercato_viol.idAsl                        \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d4 on(ticket.ticketid = d4.idcontrollo and d4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_piccoli_partenza_viol \
                ON appoggio.anno = t_piccoli_partenza_viol.anno and appoggio.idAsl = t_piccoli_partenza_viol.idAsl                        \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d5 on(ticket.ticketid = d5.idcontrollo and d5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_piccoli_sosta_viol \
                ON appoggio.anno = t_piccoli_sosta_viol.anno    and appoggio.idAsl = t_piccoli_sosta_viol.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese d6 on(ticket.ticketid = d6.idcontrollo and d6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_piccoli_trasf_viol \
                ON appoggio.anno = t_piccoli_trasf_viol.anno  and appoggio.idAsl = t_piccoli_trasf_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s1 on(ticket.ticketid = s1.idcontrollo and s1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_equidi_trasp_viol \
                ON appoggio.anno = t_equidi_trasp_viol.anno  and appoggio.idAsl = t_equidi_trasp_viol.idAsl   \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s2 on(ticket.ticketid = s2.idcontrollo and s2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_equidi_arrivo_viol \
                ON appoggio.anno = t_equidi_arrivo_viol.anno  and appoggio.idAsl = t_equidi_arrivo_viol.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s3 on(ticket.ticketid = s3.idcontrollo and s3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_equidi_mercato_viol \
                ON appoggio.anno = t_equidi_mercato_viol.anno  and appoggio.idAsl = t_equidi_mercato_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s4 on(ticket.ticketid = s4.idcontrollo and s4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_equidi_partenza_viol \
                ON appoggio.anno = t_equidi_partenza_viol.anno and appoggio.idAsl = t_equidi_partenza_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s5 on(ticket.ticketid = s5.idcontrollo and s5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_equidi_sosta_viol \
                ON appoggio.anno = t_equidi_sosta_viol.anno and appoggio.idAsl = t_equidi_sosta_viol.idAsl     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese s6 on(ticket.ticketid = s6.idcontrollo and s6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=4 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_equidi_trasf_viol \
                ON appoggio.anno = t_equidi_trasf_viol.anno and appoggio.idAsl = t_equidi_trasf_viol.idAsl \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x1 on(ticket.ticketid = x1.idcontrollo and x1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_volatili_trasp_viol \
                ON appoggio.anno = t_volatili_trasp_viol.anno  and appoggio.idAsl = t_volatili_trasp_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x2 on(ticket.ticketid = x2.idcontrollo and x2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_volatili_arrivo_viol \
                ON appoggio.anno = t_volatili_arrivo_viol.anno  and appoggio.idAsl = t_volatili_arrivo_viol.idAsl     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x3 on(ticket.ticketid = x3.idcontrollo and x3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_volatili_mercato_viol \
                ON appoggio.anno = t_volatili_mercato_viol.anno and appoggio.idAsl = t_volatili_mercato_viol.idAsl     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x4 on(ticket.ticketid = x4.idcontrollo and x4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_volatili_partenza_viol \
                ON appoggio.anno = t_volatili_partenza_viol.anno and appoggio.idAsl = t_volatili_partenza_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x5 on(ticket.ticketid = x5.idcontrollo and x5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_volatili_sosta_viol \
                ON appoggio.anno = t_volatili_sosta_viol.anno   and appoggio.idAsl = t_volatili_sosta_viol.idAsl   \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese x6 on(ticket.ticketid = x6.idcontrollo and x6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=5 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_volatili_trasf_viol \
                ON appoggio.anno = t_volatili_trasf_viol.anno and appoggio.idAsl = t_volatili_trasf_viol.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r1 on(ticket.ticketid = r1.idcontrollo and r1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_altre_trasp_viol \
                ON appoggio.anno = t_altre_trasp_viol.anno   and appoggio.idAsl = t_altre_trasp_viol.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r2 on(ticket.ticketid = r2.idcontrollo and r2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_altre_arrivo_viol \
                ON appoggio.anno = t_altre_arrivo_viol.anno  and appoggio.idAsl = t_altre_arrivo_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r3 on(ticket.ticketid = r3.idcontrollo and r3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_altre_mercato_viol \
                ON appoggio.anno = t_altre_mercato_viol.anno  and appoggio.idAsl = t_altre_mercato_viol.idAsl   \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r4 on(ticket.ticketid = r4.idcontrollo and r4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_altre_partenza_viol \
                ON appoggio.anno = t_altre_partenza_viol.anno  and appoggio.idAsl = t_altre_partenza_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r5 on(ticket.ticketid = r5.idcontrollo and r5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_altre_sosta_viol \
                ON appoggio.anno = t_altre_sosta_viol.anno  and appoggio.idAsl = t_altre_sosta_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese r6 on(ticket.ticketid = r6.idcontrollo and r6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=6 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_altre_trasf_viol \
                ON appoggio.anno = t_altre_trasf_viol.anno and appoggio.idAsl = t_altre_trasf_viol.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y1 on(ticket.ticketid = y1.idcontrollo and y1.tipoispezione = 1) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_buf_trasp_viol \
                ON appoggio.anno = t_buf_trasp_viol.anno   and appoggio.idAsl = t_buf_trasp_viol.idAsl  \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y2 on(ticket.ticketid = y2.idcontrollo and y2.tipoispezione = 2) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_buf_arrivo_viol \
                ON appoggio.anno = t_buf_arrivo_viol.anno and appoggio.idAsl = t_buf_arrivo_viol.idAsl     \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y3 on(ticket.ticketid = y3.idcontrollo and y3.tipoispezione = 3) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_buf_mercato_viol \
                ON appoggio.anno = t_buf_mercato_viol.anno and appoggio.idAsl = t_buf_mercato_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y4 on(ticket.ticketid = y4.idcontrollo and y4.tipoispezione = 4) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_buf_partenza_viol \
                ON appoggio.anno = t_buf_partenza_viol.anno and appoggio.idAsl = t_buf_partenza_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y5 on(ticket.ticketid = y5.idcontrollo and y5.tipoispezione = 5) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_buf_sosta_viol \
                ON appoggio.anno = t_buf_sosta_viol.anno  and appoggio.idAsl = t_buf_sosta_viol.idAsl    \
LEFT JOIN (select SUM(animali),site_id as idAsl  , date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese y6 on(ticket.ticketid = y6.idcontrollo and y6.tipoispezione = 6) where tipologia = 3 and animalitrasportati=10 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_buf_trasf_viol \
                ON appoggio.anno = t_buf_trasf_viol.anno  and appoggio.idAsl = t_buf_trasf_viol.idAsl                          \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p1 on(ticket.ticketid = p1.idcontrollo and p1.tipoispezione = 1) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)   t_trasp_mezzi_viol \
                ON appoggio.anno = t_trasp_mezzi_viol.anno and appoggio.idAsl = t_trasp_mezzi_viol.idAsl \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p2 on(ticket.ticketid = p2.idcontrollo and p2.tipoispezione = 2) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl) t_arrivo_mezzi_viol \
                ON appoggio.anno = t_arrivo_mezzi_viol.anno and appoggio.idAsl = t_arrivo_mezzi_viol.idAsl \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p3 on(ticket.ticketid = p3.idcontrollo and p3.tipoispezione = 3) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_mercato_mezzi_viol \
                ON appoggio.anno = t_mercato_mezzi_viol.anno and appoggio.idAsl = t_mercato_mezzi_viol.idAsl \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p4 on(ticket.ticketid = p4.idcontrollo and p4.tipoispezione = 4) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)  t_partenza_mezzi_viol \
                ON appoggio.anno = t_partenza_mezzi_viol.anno and appoggio.idAsl = t_partenza_mezzi_viol.idAsl \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p5 on(ticket.ticketid = p5.idcontrollo and p5.tipoispezione = 5) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_sosta_mezzi_viol \
                ON appoggio.anno = t_sosta_mezzi_viol.anno and appoggio.idAsl = t_sosta_mezzi_viol.idAsl \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket join tipocontrolloufficialeimprese p6 on(ticket.ticketid = p6.idcontrollo and p6.tipoispezione = 6) where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE \
                group by date_part('year',assigned_date),idAsl)t_trasf_mezzi_viol \
                ON appoggio.anno = t_trasf_mezzi_viol.anno and appoggio.idAsl = t_trasf_mezzi_viol.idAsl \
LEFT JOIN (select SUM(mezziispezionati),site_id as idAsl, date_part('year',assigned_date) as anno   \
                from ticket where tipologia = 3 and provvedimenti_prescrittivi = 4  and ncrilevate = TRUE                                                                                                                                                                                                                                                                                                                                                                                                                         \
                group by date_part('year',assigned_date),idAsl)t_cd_mezzi_viol \
                ON appoggio.anno = t_cd_mezzi_viol.anno and  appoggio.idAsl = t_cd_mezzi_viol.idAsl \
join lookup_site_id asl on (asl.code = appoggio.idAsl); 
livelloLOG = WARNING            
                